<!DOCTYPE html>




<html class="theme-next gemini" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="编程," />










<meta name="description" content="python学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="python_note">
<meta property="og:url" content="https://super5-22.github.io/2024/05/11/python-note/index.html">
<meta property="og:site_name" content="Luo">
<meta property="og:description" content="python学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20240512181744181.png">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20210517163649589.png">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20210517165314243.png">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20210518194759876.png">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20210518194932922.png">
<meta property="og:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20210519143812860.png">
<meta property="article:published_time" content="2024-05-11T15:07:26.000Z">
<meta property="article:modified_time" content="2024-09-08T13:41:32.470Z">
<meta property="article:author" content="Luoshuqiang">
<meta property="article:tag" content="编程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://super5-22.github.io/2024/05/11/python-note/image-20240512181744181.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://super5-22.github.io/2024/05/11/python-note/"/>





  <title>python_note | Luo</title>
  








<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Luo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://super5-22.github.io/2024/05/11/python-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Luo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">python_note</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2024-05-11T23:07:26+08:00">
                2024-05-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index">
                    <span itemprop="name">计算机</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>python学习笔记</p>
<span id="more"></span>

<h1 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p><img src="image-20240512181744181.png" alt="image-20240512181744181"></p>
<p><strong>有序序列：</strong>列表、字符串</p>
<p><strong>无序序列</strong>：set、</p>
<ul>
<li>因为集合是无序的，所以当集合中存在两个同样的元素的时候，Python 只会保存其中的一个（唯一性）；</li>
<li>同时为了确保其中不包含同样的元素，集合中放入的元素只能是不可变的对象（确定性）。</li>
</ul>
<h3 id="python-模块载入"><a href="#python-模块载入" class="headerlink" title="python 模块载入"></a>python 模块载入</h3><ul>
<li>为了提高效率，Python 只会载入模块一次，已经载入的模块再次载入时，Python 并不会真正执行载入操作，哪怕模块的内容已经改变。</li>
<li>需要重新导入模块时，可以使用 reload 强制重新载入它，例如：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> imp <span class="keyword">import</span> reload</span><br><span class="line">reload(ex1)</span><br></pre></td></tr></table></figure>

<h3 id="删除之前生成的文件："><a href="#删除之前生成的文件：" class="headerlink" title="删除之前生成的文件："></a>删除之前生成的文件：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.remove(<span class="string">&#x27;ex1.py&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="捕捉所有异常"><a href="#捕捉所有异常" class="headerlink" title="捕捉所有异常"></a>捕捉所有异常</h3><ul>
<li>将except 的值改成 Exception 类，来捕获所有的异常</li>
</ul>
<h3 id="try-x2F-except-else"><a href="#try-x2F-except-else" class="headerlink" title="try&#x2F;except else"></a>try&#x2F;except else</h3><ul>
<li>try&#x2F;except 块有一个可选的关键词 else。</li>
<li>如果使用这个子句，那么必须放在所有的 except 子句之后。else 子句将在 try 子句没有发生任何异常的时候执行。</li>
</ul>
<h3 id="finally"><a href="#finally" class="headerlink" title="finally"></a>finally</h3><ul>
<li>try&#x2F;except 块还有一个可选的关键词 finally。</li>
<li>不管 try 块有没有异常， finally 块的内容总是会被执行，而且会在抛出异常前执行，因此可以用来作为安全保证，比如确保打开的文件被关闭。</li>
</ul>
<h3 id="with-方法"><a href="#with-方法" class="headerlink" title="with 方法"></a>with 方法</h3><p>事实上，Python 提供了更安全的方法，当 with 块的内容结束后，Python 会自动调用它的close 方法，确保读写的安全。</p>
<h3 id="字符串，列表，元组可以切片"><a href="#字符串，列表，元组可以切片" class="headerlink" title="字符串，列表，元组可以切片"></a>字符串，列表，元组可以切片</h3><ul>
<li>字典可以用下标访问，但是要使用key而不是数字访问所以不能切片。</li>
<li>集合和数字不能用下标访问，所以不能切片。</li>
</ul>
<h3 id="print-‘-‘-end-x3D-‘’-不换行"><a href="#print-‘-‘-end-x3D-‘’-不换行" class="headerlink" title="print(‘* ‘, end &#x3D; ‘’) #不换行"></a>print(‘* ‘, end &#x3D; ‘’) #不换行</h3><ul>
<li>包含end&#x3D;’’作为print()的一个参数，会使该函数关闭“在输出中自动包含换行”的默认行为。</li>
<li>其原理是：为end传递一个空字符串，这样print函数不会在字符串末尾添加一个换行符，而是添加一个空字符串。</li>
</ul>
<h3 id="循环中的else-语句"><a href="#循环中的else-语句" class="headerlink" title="循环中的else 语句"></a>循环中的else 语句</h3><ul>
<li>与 if 一样， while 和 for 循环后面也可以跟着 else 语句。</li>
<li>当循环<strong>正常结束</strong>时，循环条件不满足， else 被执行；</li>
<li>当循环被 <strong>break 结束</strong>时，循环条件仍然满足， else 不执行。</li>
</ul>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><p>1 算术运算符</p>
<ul>
<li>加减乘除</li>
<li>取整除：&#x2F;&#x2F;</li>
<li>取余：%</li>
<li>指数：**</li>
</ul>
<p>2 赋值运算符</p>
<ul>
<li>多变量赋值：num1, num2, num3 &#x3D; 100, 100, ‘hello’</li>
</ul>
<p>3 注释</p>
<ul>
<li>单行注释用 # ，多行注释用’‘’  三个引号‘’‘</li>
</ul>
<h3 id="可迭代类型"><a href="#可迭代类型" class="headerlink" title="可迭代类型"></a>可迭代类型</h3><p>继承了collections模块的Iterable类型的对象都是可迭代的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</span><br><span class="line"><span class="built_in">isinstance</span>(<span class="string">&#x27;abc&#x27;</span>, Iterable) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], Iterable) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="number">123</span>, Iterable) <span class="comment"># False</span></span><br></pre></td></tr></table></figure>





<h2 id="int-常用语法"><a href="#int-常用语法" class="headerlink" title="int 常用语法"></a>int 常用语法</h2><h3 id="1-常用数据类型转换"><a href="#1-常用数据类型转换" class="headerlink" title="1 常用数据类型转换"></a>1 常用数据类型转换</h3><ul>
<li>int(x)：将X转换成一个整数</li>
<li>float(x)：将x转换成一个浮点数</li>
<li>str(x)：将对象x转换为字符串</li>
<li>eval(str)：将字符串str转换为原本的类型</li>
<li>tuple(s)：将序列s转换为一个元组</li>
<li>list(s)：将序列x转换为一个列表</li>
</ul>
<h2 id="str-常用语法"><a href="#str-常用语法" class="headerlink" title="str 常用语法"></a>str 常用语法</h2><h3 id="1-取下标和切片"><a href="#1-取下标和切片" class="headerlink" title="1 取下标和切片"></a>1 取下标和切片</h3><p>切片是指对操作的对象截取其中一部分的操作。<strong>字符串、列表、元组</strong>都支持切片操作。<br><strong>切片的语法：[起始:结束:步长]</strong></p>
<p>逆序输出字符串：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">myStr = <span class="string">&#x27;abcdefg&#x27;</span></span><br><span class="line">myStr[::-<span class="number">1</span>]	<span class="comment">#正向0开始，逆向-1开始</span></span><br><span class="line"></span><br><span class="line">======</span><br><span class="line"><span class="string">&#x27;gfedcba&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-find-amp-amp-rfind"><a href="#2-find-amp-amp-rfind" class="headerlink" title="2 find &amp;&amp; rfind"></a>2 find &amp;&amp; <strong>rfind</strong></h3><p><strong>find</strong> ：检测 str 是否包含在 mystr中，如果是返回开始的<strong>索引值</strong>，否则返回-1。</p>
<p><strong>rfind</strong>：类似于 find()函数，不过是从右边开始查找</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mystr.find(<span class="built_in">str</span>, start=<span class="number">0</span>, end=<span class="built_in">len</span>(mystr))</span><br><span class="line">mystr.rfind(<span class="built_in">str</span>, start=<span class="number">0</span>,end=<span class="built_in">len</span>(mystr) )</span><br><span class="line"></span><br><span class="line"><span class="comment"># example</span></span><br><span class="line">mystr = <span class="string">&quot;hello world and hello python&quot;</span></span><br><span class="line">mystr.find(<span class="string">&quot;python&quot;</span>)</span><br><span class="line">mystr.find(<span class="string">&quot;python&quot;</span>, <span class="number">0</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">=====</span><br><span class="line"><span class="number">22</span></span><br><span class="line">-<span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="3-index-amp-amp-rindex"><a href="#3-index-amp-amp-rindex" class="headerlink" title="3 index &amp;&amp; rindex"></a>3 index &amp;&amp; <strong>rindex</strong></h3><p><strong>index</strong> ：跟find()方法一样，只不过如果str不在 mystr中会报一个异常</p>
<p><strong>rindex</strong>：类似于 index()，不过是从右边开始.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mystr.index(<span class="built_in">str</span>, start=<span class="number">0</span>, end=<span class="built_in">len</span>(mystr))</span><br></pre></td></tr></table></figure>

<h3 id="4-isalpha-amp-amp-isdigit-amp-amp-isalnum-amp-amp-isspace"><a href="#4-isalpha-amp-amp-isdigit-amp-amp-isalnum-amp-amp-isspace" class="headerlink" title="4 **isalpha **&amp;&amp; isdigit &amp;&amp; isalnum &amp;&amp; isspace"></a>4 **isalpha **&amp;&amp; <strong>isdigit</strong> &amp;&amp; <strong>isalnum</strong> &amp;&amp; <strong>isspace</strong></h3><p><strong>isalpha <strong>：如果 mystr 所有字符都是</strong>字母</strong> 则返回 True,否则返回 False</p>
<p><strong>isdigit</strong>：如果 mystr 只包含<strong>数字</strong>则返回 True，否则返回 False</p>
<p><strong>isalnum</strong>：如果 mystr 所有字符都是<strong>字母或数字</strong>则返回 True,否则返回 False</p>
<p><strong>isspace</strong>：如果 mystr 中只包含空格，则返回 True，否则返回 False</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mystr.isalpha()</span><br><span class="line">mystr.isdigit()</span><br><span class="line">mystr.isalnum()</span><br><span class="line">mystr.isspace()</span><br></pre></td></tr></table></figure>

<h3 id="5-join：连接"><a href="#5-join：连接" class="headerlink" title="5 join：连接"></a>5 <strong>join</strong>：连接</h3><p>mystr 中每个元素后面插入str,构造出一个新的字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span>.join(mystr)</span><br><span class="line"></span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;-&#x27;</span></span><br><span class="line">mystr = <span class="string">&#x27;hello&#x27;</span></span><br><span class="line"><span class="built_in">str</span>.join(mystr)</span><br><span class="line"></span><br><span class="line">=====</span><br><span class="line"><span class="string">&#x27;h-e-l-l-o&#x27;</span></span><br></pre></td></tr></table></figure>

<p>s.join(sequence) 的作用是以 s 为连接符将序列 sequence 中的元素连接起来，并返回连接后得到的新字符串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27; &#x27;</span></span><br><span class="line">s.join(numbers)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;1 2 3 4 5&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="6-replace"><a href="#6-replace" class="headerlink" title="6 replace"></a>6 <strong>replace</strong></h3><p>把 mystr 中所有的 str1 替换成 str2,如果 count 指定，则替换不超过 count 次</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mystr.replace(str1, str2,  mystr.count(str1))<span class="comment"># 默认替换所有</span></span><br><span class="line"></span><br><span class="line">mystr = <span class="string">&#x27;hello python and python and python&#x27;</span></span><br><span class="line">mystr.replace(<span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;world&#x27;</span>) <span class="comment"># &#x27;hello world and world and world&#x27;</span></span><br><span class="line">mystr.replace(<span class="string">&#x27;python&#x27;</span>, <span class="string">&#x27;world&#x27;</span>,<span class="number">2</span>) <span class="comment"># &#x27;hello world and world and python&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-strip-amp-amp-lstrip-amp-amp-rstrip"><a href="#7-strip-amp-amp-lstrip-amp-amp-rstrip" class="headerlink" title="7 strip &amp;&amp; lstrip &amp;&amp; rstrip"></a>7 <strong>strip</strong> &amp;&amp; <strong>lstrip</strong> &amp;&amp; <strong>rstrip</strong></h3><p><strong>strip</strong> ：删除mystr字符串两端的空白字符</p>
<p><strong>lstrip</strong> ：删除 mystr 左边的空白字符</p>
<p><strong>rstrip</strong>：删除 mystr 字符串末尾的空白字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mystr.strip()</span><br><span class="line">mystr.lstrip()</span><br><span class="line">mystr.rstrip()</span><br></pre></td></tr></table></figure>

<h3 id="8-title-amp-amp-capitalize"><a href="#8-title-amp-amp-capitalize" class="headerlink" title="8 title  &amp;&amp; capitalize"></a>8 <strong>title</strong>  &amp;&amp; <strong>capitalize</strong></h3><p><strong>title() ：</strong>把字符串的<strong>每个单词</strong>首字母大写</p>
<p>**capitalize()**：把字符串的第一个字符大写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mystr.title()</span><br><span class="line">mystr.capitalize()</span><br><span class="line"></span><br><span class="line">mystr = <span class="string">&#x27;hello python&#x27;</span></span><br><span class="line">mystr.title() <span class="comment"># &#x27;Hello Python&#x27;</span></span><br><span class="line">mystr.capitalize() <span class="comment"># &#x27;Hello python&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="9-count"><a href="#9-count" class="headerlink" title="9 count"></a>9 <strong>count</strong></h3><p>返回 str在start和end之间 在 mystr里面出现的次数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mystr.count(<span class="built_in">str</span>, start=<span class="number">0</span>, end=<span class="built_in">len</span>(mystr))</span><br></pre></td></tr></table></figure>

<h3 id="10-split"><a href="#10-split" class="headerlink" title="10 split"></a>10 <strong>split</strong></h3><p>以 str 为分隔符切片 mystr，如果 maxsplit有指定值，则仅分隔 maxsplit 个子字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mystr.split(<span class="built_in">str</span>=<span class="string">&quot; &quot;</span>, maxsplit)</span><br><span class="line"></span><br><span class="line">mystr = <span class="string">&#x27;hello python he he&#x27;</span></span><br><span class="line">mystr.split(<span class="string">&#x27; &#x27;</span>) <span class="comment"># [&#x27;hello&#x27;, &#x27;python&#x27;, &#x27;he&#x27;, &#x27;he&#x27;]</span></span><br><span class="line">mystr.split(<span class="string">&#x27; &#x27;</span>, <span class="number">2</span>) <span class="comment"># [&#x27;hello&#x27;, &#x27;python&#x27;, &#x27;he he&#x27;]</span></span><br></pre></td></tr></table></figure>

<h3 id="11-startswith-amp-amp-endswith"><a href="#11-startswith-amp-amp-endswith" class="headerlink" title="11 **startswith ** &amp;&amp; endswith"></a>11 **startswith ** &amp;&amp; <strong>endswith</strong></h3><p> **startswith **：检查字符串是否是以 hello 开头, 是则返回 True，否则返回 False。</p>
<p><strong>endswith</strong>：检查字符串是否以obj结束，如果是返回True,否则返回 False.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mystr.startswith(hello)</span><br><span class="line">mystr.endswith(obj)</span><br></pre></td></tr></table></figure>

<h3 id="12-lower-amp-amp-upper"><a href="#12-lower-amp-amp-upper" class="headerlink" title="12 **lower **&amp;&amp; upper"></a>12 **lower **&amp;&amp; <strong>upper</strong></h3><p>**lower **：转换 mystr 中所有大写字符为小写、</p>
<p><strong>upper</strong>：转换 mystr 中的小写字母为大写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mystr.lower()</span><br><span class="line">mystr.upper()</span><br></pre></td></tr></table></figure>

<h3 id="13-ljust-amp-amp-rjust-amp-amp-center"><a href="#13-ljust-amp-amp-rjust-amp-amp-center" class="headerlink" title="13 ljust &amp;&amp; rjust &amp;&amp; center"></a>13 <strong>ljust</strong> &amp;&amp; <strong>rjust</strong> &amp;&amp; <strong>center</strong></h3><p><strong>ljust</strong>：返回一个原字符串左对齐,并使用空格填充至长度 width 的新字符串</p>
<p><strong>rjust</strong>：返回一个原字符串右对齐,并使用空格填充至长度 width 的新字符串</p>
<p><strong>center</strong>：返回一个原字符串居中,并使用空格填充至长度 width 的新字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mystr.ljust(width)</span><br><span class="line">mystr.rjust(width)</span><br><span class="line">mystr.center(width)</span><br></pre></td></tr></table></figure>

<h3 id="14-partition-amp-amp-rpartition"><a href="#14-partition-amp-amp-rpartition" class="headerlink" title="14 **partition **&amp;&amp; rpartition"></a>14 **partition **&amp;&amp; <strong>rpartition</strong></h3><p>**partition **：把mystr以str分割成三部分,str前，str和str后</p>
<p><strong>rpartition</strong>：类似于 partition()函数,不过是从右边开始.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mystr.partition(<span class="built_in">str</span>)</span><br><span class="line">mystr.rpartition(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line">mystr = <span class="string">&#x27;hello python and python and python&#x27;</span></span><br><span class="line">mystr.partition(<span class="string">&#x27;python&#x27;</span>)  <span class="comment"># (&#x27;hello &#x27;, &#x27;python&#x27;, &#x27; and python and python&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="15-splitlines"><a href="#15-splitlines" class="headerlink" title="15 splitlines"></a>15 <strong>splitlines</strong></h3><p>按照行分隔，返回一个包含各行作为元素的列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mystr.splitlines()</span><br><span class="line"></span><br><span class="line">mystr = <span class="string">&#x27;hello \n python \n and \n python \n and \n python&#x27;</span></span><br><span class="line">mystr.splitlines() <span class="comment"># [&#x27;hello &#x27;, &#x27; python &#x27;, &#x27; and &#x27;, &#x27; python &#x27;, &#x27; and &#x27;, &#x27; python&#x27;]</span></span><br></pre></td></tr></table></figure>





<h2 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h2><h3 id="1-查找"><a href="#1-查找" class="headerlink" title="1 查找"></a>1 查找</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> get方法</span><br><span class="line">用键可以找到该键对应的值，但是当字典中没有这个键的时候，Python 会报错，</span><br><span class="line">这时候可以使用字典的 get 方法来处理这种情况，其用法如下：</span><br><span class="line">	</span><br><span class="line">d.get(key, default = <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">返回字典中键 key 对应的值，如果没有这个键，返回 default 指定的值（默认是 <span class="literal">None</span> ）。</span><br><span class="line">	</span><br><span class="line">a = &#123;&#125;</span><br><span class="line">a[<span class="string">&quot;one&quot;</span>] = <span class="string">&quot;this is number 1&quot;</span></span><br><span class="line">a[<span class="string">&quot;two&quot;</span>] = <span class="string">&quot;this is number 2&quot;</span></span><br><span class="line">a.get(<span class="string">&quot;three&quot;</span>, <span class="string">&quot;undefined&quot;</span>)</span><br><span class="line">	</span><br><span class="line">&gt;&gt; <span class="string">&#x27;undefined&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> 字典的遍历</span><br><span class="line">d1 = &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;jack&#x27;</span>, <span class="string">&#x27;age&#x27;</span>:<span class="number">20</span>, <span class="string">&#x27;class&#x27;</span>:<span class="string">&#x27;people&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> d1:</span><br><span class="line">	<span class="built_in">print</span>(key)</span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> d1.values():</span><br><span class="line">    <span class="built_in">print</span>(value)</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> d1.items():</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> <span class="built_in">enumerate</span>()：用于将一个可遍历对象组合为一个索引序列，同时列出数据和索引。</span><br><span class="line">chars = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i, <span class="built_in">chr</span> <span class="keyword">in</span> <span class="built_in">enumerate</span>(chars):</span><br><span class="line">    <span class="built_in">print</span>(i, end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>)</span><br><span class="line">    </span><br><span class="line"><span class="number">4</span> 获取字典的值</span><br><span class="line">d1.keys()</span><br><span class="line">d1.values()</span><br><span class="line">d1.items()</span><br></pre></td></tr></table></figure>

<h3 id="2-删除元素"><a href="#2-删除元素" class="headerlink" title="2 删除元素"></a>2 删除元素</h3><ul>
<li>del</li>
<li>clear（）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">info = &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;sex&#x27;</span>:<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;address&#x27;</span>:<span class="string">&#x27;shanghai&#x27;</span>&#125;</span><br><span class="line"><span class="keyword">del</span> info[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">info.clear()</span><br></pre></td></tr></table></figure>



<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><h3 id="1-长度、加法、乘法"><a href="#1-长度、加法、乘法" class="headerlink" title="1 长度、加法、乘法"></a>1 长度、加法、乘法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> 长度：用 <span class="built_in">len</span> 查看列表长度</span><br><span class="line"><span class="number">2</span> 加法: 相当于将两个列表按顺序连接</span><br><span class="line"><span class="number">3</span> 乘法：列表与整数相乘，相当于将列表重复相加</span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">b = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">a+b <span class="comment"># [1, 2, 3, 2, 3, 4]	</span></span><br><span class="line">a * <span class="number">3</span> <span class="comment"># [1, 2, 3, 1, 2, 3, 1, 2, 3]</span></span><br></pre></td></tr></table></figure>

<h3 id="2-添加元素"><a href="#2-添加元素" class="headerlink" title="2 添加元素"></a>2 添加元素</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> append 每次只添加一个元素，并不会因为这个元素是序列而将其展开：</span><br><span class="line">a = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line">a.append([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">	</span><br><span class="line">&gt;&gt; [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]]</span><br><span class="line">	</span><br><span class="line"><span class="number">2</span> extend: 向列表添加序列元素</span><br><span class="line">extend(lst) 将序列 lst 的元素依次添加到列表 l 的最后，作用相当于 l += lst。</span><br><span class="line">	</span><br><span class="line">a = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]</span><br><span class="line">a.extend([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">	</span><br><span class="line">&gt;&gt; [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="number">3</span> insert: 插入元素</span><br><span class="line">insert(idx, ob) 在索引 idx 处插入 ob ，之后的元素依次后移。</span><br><span class="line">	</span><br><span class="line">a = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">11</span>]</span><br><span class="line"><span class="comment"># 在索引 3 插入 &#x27;a&#x27;</span></span><br><span class="line">a.insert(<span class="number">3</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line">&gt;&gt; [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">13</span>, <span class="number">11</span>]</span><br></pre></td></tr></table></figure>

<h3 id="3-查找"><a href="#3-查找" class="headerlink" title="3 查找"></a>3 查找</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> index(ob) 返回列表中元素 ob 第一次出现的索引位置，如果 ob 不在 l 中会报错。</span><br><span class="line">	</span><br><span class="line">a = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">11</span>]</span><br><span class="line">a.index(<span class="number">11</span>)</span><br><span class="line">	</span><br><span class="line">&gt;&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span> count 查找列表中某个元素出现的次数</span><br><span class="line">a = [<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">11</span>]</span><br><span class="line">a.count(<span class="number">11</span>)</span><br><span class="line">	</span><br><span class="line">&gt;&gt; <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="number">3</span> <span class="keyword">if</span> name <span class="keyword">in</span> name_list:</span><br><span class="line">    <span class="built_in">print</span>(true)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(false)</span><br></pre></td></tr></table></figure>

<h3 id="4-删除元素"><a href="#4-删除元素" class="headerlink" title="4 删除元素"></a>4 删除元素</h3><ul>
<li>del：根据下标进行删除</li>
<li>pop：删除最后一个元素</li>
<li>remove：根据元素的值进行删除</li>
</ul>
<h3 id="5-列表生成式"><a href="#5-列表生成式" class="headerlink" title="5 列表生成式"></a>5 列表生成式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">请写出一段 Python 代码实现分组一个 <span class="built_in">list</span> 里面的元素， </span><br><span class="line">比如 [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,..<span class="number">.100</span>] 变成 [[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]....]，请编写代码实现。</span><br><span class="line">	</span><br><span class="line">a = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">101</span>)]</span><br><span class="line">b = [a[i:i+<span class="number">3</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">3</span>)]</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>

<h3 id="6-排序"><a href="#6-排序" class="headerlink" title="6 排序"></a>6 排序</h3><ul>
<li><p>sort()：默认从从小到大，参数reverse&#x3D;True可改为倒序，有大到小。</p>
</li>
<li><p>reverse()：逆序  等价于：sort(reverse&#x3D;True)</p>
</li>
</ul>
<h2 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h2><p>tuple一旦初始化就不能修改。因为tuple不可变，所以代码更安全。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">classmates = (<span class="string">&#x27;Michael&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&quot;Tracy&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个空元组</span></span><br><span class="line">t = ()</span><br><span class="line"><span class="comment"># 只有一个元素的tuple定义需要加一个逗号，否则会被认为是括号运算符</span></span><br><span class="line">t = (<span class="number">1</span>,)</span><br><span class="line"></span><br><span class="line"><span class="comment"># “可变的”元组</span></span><br><span class="line">a = (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>])</span><br><span class="line">a[<span class="number">2</span>][<span class="number">0</span>] = <span class="string">&#x27;X&#x27;</span></span><br><span class="line">a[<span class="number">2</span>][<span class="number">1</span>] = <span class="string">&#x27;Y&#x27;</span></span><br><span class="line">a <span class="comment"># (&#x27;a&#x27;, &#x27;b&#x27;, [&#x27;X&#x27;, &#x27;Y&#x27;])</span></span><br></pre></td></tr></table></figure>



<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">func</span>():</span><br><span class="line">    <span class="string">&quot;函数的文档说明&quot;</span></span><br><span class="line">    函数体</span><br><span class="line">   </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test1</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;求两数的和&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%d&quot;</span> %(a+b))</span><br><span class="line"><span class="built_in">print</span>(test1.__doc__) <span class="comment"># 求两数的和</span></span><br></pre></td></tr></table></figure>

<h3 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h3><ul>
<li>位置参数</li>
<li>默认参数</li>
<li>可变参数</li>
<li>命名关键字参数</li>
</ul>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">calc</span>(<span class="params">*numbers</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> numbers:</span><br><span class="line">        <span class="built_in">sum</span> = <span class="built_in">sum</span> + n * n</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line">calc(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>) <span class="comment"># 14</span></span><br><span class="line"></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">calc(*nums) <span class="comment"># *nums 表示把nums这个list的所有元素作为可变参数传进去。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键字参数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person</span>(<span class="params">name, age, **kw</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;city&#x27;</span> <span class="keyword">in</span> kw:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">   	<span class="keyword">if</span> <span class="string">&#x27;job&#x27;</span> <span class="keyword">in</span> kw:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;name&#x27;</span>:name, <span class="string">&#x27;age&#x27;</span>:age, <span class="string">&#x27;other&#x27;</span>:kw)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 命名关键字参数：可以限制关键字参数的名字</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person</span>(<span class="params">name, age, *, city, job</span>):</span><br><span class="line">    <span class="built_in">print</span>(name, age, city, job)</span><br><span class="line"><span class="comment"># 命名关键字参数需要一个特殊分隔符*，*后面的参数被视为命名关键字参数</span></span><br><span class="line"><span class="comment"># 如果函数中定义了一个可变参数，就不用*符号了。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">person</span>(<span class="params">name, age, *args, city, job</span>):</span><br><span class="line">    <span class="built_in">print</span>(name, age, args, city, job)</span><br><span class="line"><span class="comment"># 参数city和job是命名关键字参数，必须传入参数名。</span></span><br><span class="line">person(<span class="string">&#x27;jack&#x27;</span>, <span class="number">24</span>, city=<span class="string">&#x27;HK&#x27;</span>, job=<span class="string">&#x27;player&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>对于任意函数，都可以通过类似func(*args, **kw)的形式调用它，无论它的参数是如何定义的。</p>
<h3 id="局部变量"><a href="#局部变量" class="headerlink" title="局部变量"></a>局部变量</h3><ul>
<li>局部变量：函数内部的变量</li>
<li>当局部变量和全局变量重名时，函数内部优先使用局部变量</li>
<li>通过global将局部变量绑定到全局变量，可以在函数中修改全局变量。</li>
</ul>
<h3 id="返回函数"><a href="#返回函数" class="headerlink" title="返回函数"></a>返回函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">lazy_sum</span>(<span class="params">*args</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sum</span>():</span><br><span class="line">        ax = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> args:</span><br><span class="line">            ax = ax + n</span><br><span class="line">        <span class="keyword">return</span> ax</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line">f = lazy_sum(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>) <span class="comment"># 返回一个函数</span></span><br><span class="line">f() <span class="comment"># 调用函数计算</span></span><br></pre></td></tr></table></figure>



<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h3><ul>
<li>返回的函数中引用了局部变量的函数就是闭包。</li>
<li>返回函数不要引用任何循环变量、或者后续会发生变化的变量。</li>
</ul>
<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="keyword">lambda</span> x: x*x</span><br><span class="line">f(<span class="number">5</span>) <span class="comment"># 25</span></span><br></pre></td></tr></table></figure>



<h3 id="偏函数"><a href="#偏函数" class="headerlink" title="偏函数"></a>偏函数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> functools</span><br><span class="line">int2 = functools.partial(<span class="built_in">int</span>, base=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p><code>functools.partial</code>的作用就是把一个函数的某些参数给固定住，返回一个新的函数。</p>
<h2 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h2><ul>
<li><p>当一个巨大的列表中的大部分元素都不是必备的时候，白白浪费了空间，可以使用生成器（generator）来存储算法，避免大量空间的使用。</p>
</li>
<li><p>generator是可迭代对象</p>
</li>
</ul>
<p>generator创建方法1：类似于列表生成式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建生成器</span></span><br><span class="line">L = [x*x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)] <span class="comment"># list</span></span><br><span class="line">g = (x*x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)) <span class="comment"># generator</span></span><br><span class="line"><span class="comment"># 获取生成器的下一个元素：</span></span><br><span class="line"><span class="built_in">next</span>(g)</span><br><span class="line"><span class="comment"># 使用for循环获取生成器中的元素</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> g:</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>generator创建方法2：如果一个函数定义中包含了yield关键字，该函数就是一个generator。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params"><span class="built_in">max</span></span>):</span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="built_in">max</span>:</span><br><span class="line">        <span class="keyword">yield</span> b</span><br><span class="line">        a, b = b, a+b</span><br><span class="line">        n = n+<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;done&#x27;</span></span><br><span class="line"><span class="comment"># 使用for循环来获取下一个返回值，并捕获取generator的return语句的返回值，返回值包含在StopIteration 的 value 中。</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> fib(<span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(n)</span><br><span class="line">g = fib(<span class="number">6</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        x = <span class="built_in">next</span>(g)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;g: &quot;</span>, x)</span><br><span class="line">    <span class="keyword">except</span> StopIteration <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Generator return value:&quot;</span>, e.value)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h2 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h2><p>可以直接使用for循环的数据类型有：</p>
<ul>
<li>集合数据类型：list、tuple、dict、set、str等</li>
<li>生成器、生成器函数</li>
</ul>
<p>这些可直接作用于for循环的对象就是<strong>可迭代对象</strong>：<strong>Iterable</strong></p>
<p>可以被next()函数调用并不断返回下一个值的对象称为<strong>迭代器</strong>：<strong>Iterator</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterable</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Iterator</span><br><span class="line"><span class="built_in">isinstance</span>([], Iterable) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>((x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)), Iterable) <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">isinstance</span>((x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)), Iterator) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>([], Iterator) <span class="comment"># False</span></span><br><span class="line"><span class="built_in">isinstance</span>(&#123;&#125;, Iterator) <span class="comment"># False</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="string">&#x27;abc&#x27;</span>, Iterator) <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用iter()将list、dict、str变成Iterator</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="built_in">iter</span>([]), Iterator) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">isinstance</span>(<span class="built_in">iter</span>(<span class="string">&#x27;abc&#x27;</span>), Iterator) <span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<p>生成器都是Iterator对象，但list、dict、str虽然是<strong>可迭代对象</strong>，却不是迭代器。</p>
<p><strong>可以通过iter()函数将list、dict、str等Iterable变成Iterator。</strong></p>
<p><strong>小结</strong></p>
<ul>
<li>凡是可用作for循环的对象都是Iterable类型；</li>
<li>凡是可用作next()函数的对象都是Iterator类型，他们表示一个<strong>惰性计算的序列</strong>。</li>
<li>集合数据类型可以通过iter() 函数获得一个Iterator对象。</li>
</ul>
<h2 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h2><p>在代码运行期间动态增加功能的方式，称为装饰器Decorator</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kw</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;call %s():&#x27;</span>% func.__name__)</span><br><span class="line">        <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">   	<span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等价于</span></span><br><span class="line"><span class="meta">@log</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">now</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;2024-5-13&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 带参数的decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">log</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mydecorator</span>(<span class="params">func</span>):</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kw</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;%s %s():&#x27;</span> % (text, func.__name__))</span><br><span class="line">            <span class="keyword">return</span> func(*args, **kw)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> mydecorator</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用</span></span><br><span class="line"><span class="meta">@log(<span class="params"><span class="string">&#x27;execute&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">now</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;2024-05-13&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<p>该log函数接收一个函数作为参数，并返回函数，是一个装饰器。可用@语法替代。</p>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p>python 的类里提供的，<strong>两个下划线开始，两个下划线结束</strong>的方法，就是魔法方法。</p>
<h3 id="init-方法"><a href="#init-方法" class="headerlink" title="__init__()方法"></a><code>__init__()</code>方法</h3><p>创建对象时自动调用。</p>
<h3 id="str-方法"><a href="#str-方法" class="headerlink" title="__str__() 方法"></a><code>__str__()</code> 方法</h3><p>该方法只有一个self参数，<strong>返回要显示的数据</strong>，重写了该方法的类可以直接print()其事例，打印的结果是<code>__str__()</code>方法返回的数据。</p>
<p>通常通过<code>__str__()</code>方法来打印对象的描述信息。</p>
<h3 id="del-方法"><a href="#del-方法" class="headerlink" title="__del__()方法"></a><code>__del__()</code>方法</h3><p>当对象被删除时，默认调用。</p>
<h3 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h3><ul>
<li>可以单继承和多继承。</li>
<li>多继承的多个父类中有同名的属性和方法，则默认使用第一个父类的属性和方法。</li>
</ul>
<h3 id="多态"><a href="#多态" class="headerlink" title="多态"></a>多态</h3><p>python是弱类型，无论参数是什么，都能传对象指向它。</p>
<h3 id="类属性和实例属性"><a href="#类属性和实例属性" class="headerlink" title="类属性和实例属性"></a>类属性和实例属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    name = <span class="string">&#x27;Tom&#x27;</span> <span class="comment"># 公有的类属性</span></span><br><span class="line">    __age = <span class="number">12</span> <span class="comment"># 私有的类属性</span></span><br><span class="line"></span><br><span class="line">p = People()</span><br><span class="line"><span class="built_in">print</span>(p.name) <span class="comment"># 正确</span></span><br><span class="line"><span class="built_in">print</span>(People.name) <span class="comment"># 正确</span></span><br><span class="line"><span class="built_in">print</span>(p.__age) <span class="comment"># 错误，不能在类外通过实例对象访问私有的类属性</span></span><br><span class="line"><span class="built_in">print</span>(People.__age) <span class="comment"># 错误，不能在类外通过类对象访问私有的类属性</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    address = <span class="string">&#x27;山东&#x27;</span> <span class="comment"># 类属性</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.name = <span class="string">&#x27;xiaowang&#x27;</span> <span class="comment"># 实例属性</span></span><br><span class="line">        self.age = <span class="number">20</span> <span class="comment"># 实例属性    </span></span><br></pre></td></tr></table></figure>



<h3 id="类方法和静态方法"><a href="#类方法和静态方法" class="headerlink" title="类方法和静态方法"></a>类方法和静态方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    country = <span class="string">&#x27;china&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 类方法， 用classmethod来进行修饰</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_country</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="keyword">return</span> cls.country</span><br><span class="line">    </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    country = <span class="string">&#x27;china&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 静态方法</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_country</span>():</span><br><span class="line">        <span class="keyword">return</span> People.country</span><br></pre></td></tr></table></figure>

<p>总结：</p>
<ul>
<li><strong>类方法的第一个参数是类对象cls</strong>，那么通过cls引用的必定是类对象的属性和方法。</li>
<li><strong>实例方法的第一个参数是实例对象self</strong>，self既可以引用类属性，也可以引用实例属性，实例属性优先级更高；</li>
<li><strong>静态方法</strong>中不需要额外定义参数。</li>
</ul>
<h3 id="new方法"><a href="#new方法" class="headerlink" title="new方法"></a>new方法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这是init方法&quot;</span>)</span><br><span class="line">     </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;这是new方法&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">object</span>.__new__(cls)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>new至少要一个参数cls，代表要实例化的类。</li>
<li>new必须要有返回值，返回实例化出来的实例。</li>
</ul>
<h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    __instance = <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, age, name</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">        	cls.__instance = <span class="built_in">object</span>.__new__(cls)</span><br><span class="line">    	<span class="keyword">return</span> cls.__instance</span><br></pre></td></tr></table></figure>



<h3 id="slots-限制class实例添加属性"><a href="#slots-限制class实例添加属性" class="headerlink" title="__slots__限制class实例添加属性"></a><code>__slots__</code>限制class实例添加属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    __slots__ = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>) <span class="comment"># 用tuple定义允许绑定的属性名称，只能通过实例添加绑定过的属性。</span></span><br></pre></td></tr></table></figure>



<h3 id="property"><a href="#property" class="headerlink" title="@property"></a>@property</h3><p>@property 装饰器负责把一个方法变成属性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_score</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0~100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 使用装饰器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0~100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br></pre></td></tr></table></figure>



<h3 id="枚举类"><a href="#枚举类" class="headerlink" title="枚举类"></a>枚举类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</span><br><span class="line"></span><br><span class="line"><span class="meta">@unique </span><span class="comment"># 该装饰器帮助我们检查保证没有重复值</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Weekday</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    Sun = <span class="number">0</span></span><br><span class="line">    Mon = <span class="number">1</span></span><br><span class="line">    Tue = <span class="number">2</span></span><br></pre></td></tr></table></figure>











<h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><h3 id="sys模块"><a href="#sys模块" class="headerlink" title="sys模块"></a>sys模块</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>():</span><br><span class="line">    args = sys.argv</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(args)==<span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;no argument&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(args)==<span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;hello, %s!&#x27;</span> % args[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Too many argument!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	test()</span><br></pre></td></tr></table></figure>

<p>argv至少有一个元素，因为第一个参数永远是该.py文件的文件名。</p>
<ul>
<li>运行<code>python hello.py</code> 获得的<code>sys.argv </code> 就是<code>[&#39;hello.py&#39;]</code></li>
<li>运行<code>python hello.py Jack</code> 获得的<code>sys.argv</code> 就是 <code>[&#39;hello.py&#39;, &#39;Jack&#39;]</code></li>
</ul>
<h3 id="sys-path"><a href="#sys-path" class="headerlink" title="sys.path"></a>sys.path</h3><p><strong>python解释器搜索的路径</strong>：<code>sys.path</code></p>
<p>添加搜索目录：<code>sys.path.append(&#39;D:\\AI\\pytorch&#39;)</code></p>
<h2 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、读文件</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;/pathToFile&quot;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="comment"># 读取文件全部内容，返回一个str</span></span><br><span class="line">f.read()</span><br><span class="line"><span class="comment"># 关闭文件</span></span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 为了防止文件未被关闭，常用try...finally</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&#x27;/path/to/file&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="keyword">if</span> f:</span><br><span class="line">		f.close()</span><br><span class="line"><span class="comment"># 使用with语句来自动调用close</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/path/to/file&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读文件的方法</span></span><br><span class="line">f.read(size)</span><br><span class="line">f.readline()</span><br><span class="line">f.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读二进制文件，用‘rb’模式打开文件即可</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;/path/to/test.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/path/to/file&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&#x27;Hello, world!&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="操作文件和目录"><a href="#操作文件和目录" class="headerlink" title="操作文件和目录"></a>操作文件和目录</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.path.abspath(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">os.path.join(<span class="string">&#x27;/path/to/dir&#x27;</span>, <span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">os.mkdir(<span class="string">&#x27;/filedir&#x27;</span>)</span><br><span class="line">os.rmdir(<span class="string">&#x27;/filedir&#x27;</span>)</span><br><span class="line">os.path.split(<span class="string">&#x27;/path/to/filedir/filename&#x27;</span>) <span class="comment"># (&#x27;/path/to/filedir&#x27;, &#x27;filename&#x27;)</span></span><br><span class="line">os.path.splitext(<span class="string">&#x27;/path/to/file.txt&#x27;</span>) <span class="comment"># 得到文件扩展名</span></span><br><span class="line">&gt;&gt; (<span class="string">&#x27;/path/to/file&#x27;</span>, <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出当前目录下所有目录</span></span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> os.listdir(<span class="string">&#x27;.&#x27;</span>) <span class="keyword">if</span> os.path.isdir(x)]</span><br><span class="line"><span class="comment"># 列出所有.py文件</span></span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> os.listdir(<span class="string">&#x27;.&#x27;</span>) <span class="keyword">if</span> os.path.isfile(x) <span class="keyword">and</span> os.path.splitext(x)[<span class="number">1</span>]==<span class="string">&#x27;.py&#x27;</span>]</span><br></pre></td></tr></table></figure>



<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>使用pickle模块来实现序列化</p>
<ul>
<li><code>pickle.dumps()</code>：序列化</li>
<li><code>pickle.loads()</code>：反序列化</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line">d = dick(name=<span class="string">&#x27;Bob&#x27;</span>, age=<span class="number">20</span>, score=<span class="number">100</span>)</span><br><span class="line">pickle.dumps(d) <span class="comment"># 把对象d序列化</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;dump.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">pickle.dump(d, f)</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;dump.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">d = pickle.load(f)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>





<h1 id="高级语法"><a href="#高级语法" class="headerlink" title="高级语法"></a>高级语法</h1><h2 id="多进程"><a href="#多进程" class="headerlink" title="多进程"></a>多进程</h2><h4 id="1-multiprocessing"><a href="#1-multiprocessing" class="headerlink" title="1. multiprocessing"></a>1. multiprocessing</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_proc</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Run child process %s (%s)...&#x27;</span> % (name, os.getpid()))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;Parent process %s.&#x27;</span> % os.getpid())</span><br><span class="line">    p = Process(target=run_proc, args=(<span class="string">&#x27;test&#x27;</span>,))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Child process will start.&#x27;</span>)</span><br><span class="line">    p.start()</span><br><span class="line">    p.join() <span class="comment"># 等待子进程结束后再继续往下允许。</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Child process end.&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="2-Pool"><a href="#2-Pool" class="headerlink" title="2. Pool"></a>2. Pool</h4><p>如果要启动大量的子进程，可以用进程池的方式批量创建子进程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"><span class="keyword">import</span> os, time, random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">long_time_task</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Run task %s (%s)...&#x27;</span> % (name, os.getpid()))</span><br><span class="line">    start = time.time()</span><br><span class="line">    time.sleep(random.random()*<span class="number">3</span>)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Task %s runs %0.2f seconds.&#x27;</span>% (name, (end-start)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Parent process %s.&#x27;</span> % os.getpid())</span><br><span class="line">    p = Pool(<span class="number">4</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        p.apply_async(long_time_task, args=(i,))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Waiting for all subprocesses done...&#x27;</span>)</span><br><span class="line">    p.close()</span><br><span class="line">    p.join()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;All subprocesses done.&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="3-进程间通信"><a href="#3-进程间通信" class="headerlink" title="3 进程间通信"></a>3 进程间通信</h4><p>通过Queue、Pipes来实现</p>
<h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time, threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">loop</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;thread %s is running...&#x27;</span> % threading.current_thread().name)</span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="number">5</span>:</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;thread %s &gt;&gt;&gt; %s&#x27;</span> % (threading.current_thread().name, n))</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;thread %s ended.&#x27;</span> % tnreading.current_thread().name)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s is running...&#x27;</span> % tnreading.current_thread().name)</span><br><span class="line">t = threading.Thread(target=loop, name=<span class="string">&#x27;LoopThread&#x27;</span>)</span><br><span class="line">t.start()</span><br><span class="line">t.join()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;thread %s ended.&#x27;</span> % threading.current_thread().name)</span><br></pre></td></tr></table></figure>

<h3 id="Lock"><a href="#Lock" class="headerlink" title="Lock()"></a>Lock()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">balance = <span class="number">0</span></span><br><span class="line">lock = threading.Lock()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_thread</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">        lock.acquire()</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            change_it(n)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            lock.release() <span class="comment"># 确保一定会释放锁，防止死锁</span></span><br></pre></td></tr></table></figure>



<p>在python中，可以使用多线程，但是不能有效的利用多核。因为有一个全局的解释器锁GIL，把所有线程的执行代码都给上了锁，所以，多线程在Python中只能交替执行。</p>
<h2 id="datetime"><a href="#datetime" class="headerlink" title="datetime"></a>datetime</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">now = datetime.now() </span><br><span class="line">dt = datetime(<span class="number">2015</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">20</span>)</span><br><span class="line">dt.timestamp()</span><br></pre></td></tr></table></figure>



<h2 id="collections"><a href="#collections" class="headerlink" title="collections"></a>collections</h2><ol>
<li><code>namedtuple</code></li>
<li><code>deque</code></li>
<li><code>defaultdict</code></li>
<li><code>OrderedDict</code></li>
<li><code>Counter</code></li>
</ol>
<h1 id="python高级编程"><a href="#python高级编程" class="headerlink" title="python高级编程"></a>python高级编程</h1><h1 id="1、总览"><a href="#1、总览" class="headerlink" title="1、总览"></a>1、总览</h1><p><img src="image-20210517163649589.png" alt="image-20210517163649589"></p>
<h1 id="2、Python中一切皆对象"><a href="#2、Python中一切皆对象" class="headerlink" title="2、Python中一切皆对象"></a>2、Python中一切皆对象</h1><h2 id="2-1动态语言和静态语言的区别"><a href="#2-1动态语言和静态语言的区别" class="headerlink" title="2.1动态语言和静态语言的区别"></a>2.1动态语言和静态语言的区别</h2><ul>
<li>python的面向对象更彻底</li>
<li>Python中<strong>class</strong>也是对象, <strong>函数</strong>也是对象</li>
<li>Python中的<strong>代码和模块</strong>也是对象</li>
</ul>
<h2 id="2-2函数和类也是对象-属于python的一等公民"><a href="#2-2函数和类也是对象-属于python的一等公民" class="headerlink" title="2.2函数和类也是对象,属于python的一等公民"></a>2.2函数和类也是对象,属于python的一等公民</h2><ol>
<li>赋值给一个变量</li>
<li>可以添加到集合对象中</li>
<li>可以作为参数传递给函数</li>
<li>可以当做函数的返回值</li>
</ol>
<p>对类进行实例化的时候返回的是一个类的对象</p>
<h2 id="2-3type、object和class之间的关系"><a href="#2-3type、object和class之间的关系" class="headerlink" title="2.3type、object和class之间的关系"></a><strong>2.3type、object和class之间的关系</strong></h2><h3 id="type的两种用法"><a href="#type的两种用法" class="headerlink" title="type的两种用法"></a>type的两种用法</h3><ul>
<li>生成一个类</li>
<li>返回一个对象的类型</li>
</ul>
<p><img src="image-20210517165314243.png" alt="image-20210517165314243"></p>
<h3 id="type-gt-int-gt-1"><a href="#type-gt-int-gt-1" class="headerlink" title="type-&gt;int-&gt;1"></a>type-&gt;int-&gt;1</h3><ul>
<li>type-&gt;class-&gt;obj</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1是通过int这个类实例化的对象, int是通过type这个类实例化的对象</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="number">1</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">int</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt; </span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">MyStudent</span>(<span class="title class_ inherited__">Student</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">pass</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>stu = Student()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(stu)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Student&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(Student)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">object</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">type</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = <span class="string">&#x27;abc&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(a)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;str&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">str</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt; </span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>(<span class="built_in">type</span>)</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;type&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Student.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>MyStudent.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.Student&#x27;</span>&gt;,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">type</span>.__bases__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">object</span>.__bases__</span><br><span class="line">()</span><br></pre></td></tr></table></figure>

<h2 id="2-4python中的内置类型"><a href="#2-4python中的内置类型" class="headerlink" title="2.4python中的内置类型"></a>2.4<strong>python中的内置类型</strong></h2><h3 id="python中对象的三个特征"><a href="#python中对象的三个特征" class="headerlink" title="python中对象的三个特征"></a>python中对象的三个特征</h3><p><strong>身份</strong></p>
<ul>
<li>对象在内存中的地址,可以通过id去查看</li>
</ul>
<p><strong>类型</strong></p>
<ul>
<li>int类型、字符串类型…</li>
</ul>
<p><strong>值</strong></p>
<p><code>a = 1</code>, 1是指这个对象的值, 1会被python的int类型进行封装, 然后使用a指向1这个对象</p>
<h3 id="python中的常见内置类型"><a href="#python中的常见内置类型" class="headerlink" title="python中的常见内置类型"></a>python中的常见内置类型</h3><ul>
<li>None(全局只有一个)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">None</span></span><br><span class="line">b = <span class="literal">None</span></span><br><span class="line"><span class="comment">#a和b都是指向同一个对象</span></span><br></pre></td></tr></table></figure>

<ul>
<li>数值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> </span><br><span class="line"><span class="built_in">float</span></span><br><span class="line"><span class="built_in">complex</span></span><br><span class="line"><span class="built_in">bool</span></span><br></pre></td></tr></table></figure>

<ul>
<li>迭代类型</li>
<li>序列类型</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> </span><br><span class="line"><span class="built_in">bytes</span>、<span class="built_in">bytearray</span>、<span class="built_in">memoryview</span>(二进制序列)</span><br><span class="line"><span class="built_in">range</span> </span><br><span class="line"><span class="built_in">tuple</span> </span><br><span class="line"><span class="built_in">str</span> </span><br><span class="line">array</span><br></pre></td></tr></table></figure>

<ul>
<li>映射(dict)</li>
<li>集合</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span></span><br><span class="line"><span class="built_in">frozenset</span></span><br></pre></td></tr></table></figure>

<ul>
<li>上下文管理类型(with)</li>
<li>其他</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">模块类型</span><br><span class="line"><span class="keyword">class</span>和实例函数类型</span><br><span class="line">方法类型</span><br><span class="line">代码类型</span><br><span class="line"><span class="built_in">object</span>对象</span><br><span class="line"><span class="built_in">type</span>类型</span><br><span class="line">ellipsis类型</span><br><span class="line">notimplemented类对象</span><br></pre></td></tr></table></figure>

<h1 id="3、魔法函数"><a href="#3、魔法函数" class="headerlink" title="3、魔法函数"></a>3、<strong>魔法函数</strong></h1><h2 id="3-1什么是魔法函数"><a href="#3-1什么是魔法函数" class="headerlink" title="3.1什么是魔法函数?"></a>3.1什么是魔法函数?</h2><ul>
<li>Python里面的魔法函数，是以<strong>双下划线开头和结尾</strong></li>
<li>魔法函数不依赖任何类，并且可以随时调用</li>
<li><strong>一旦类里面加上一些特定的魔法函数，整个类就被附加了一些特定的功能</strong>.</li>
<li>魔法函数定义了我们不需要显式的调用它，Python解释器自己会知道什么情况下会调用，我们在使用相应的语法的时候就会自动调用。</li>
<li>魔法函数和本身的类没有关系，和类的父类，object也没有关系。魔法函数可以写到任意一个类中，跟继不继承没有必然的关系。</li>
</ul>
<h2 id="3-2实例"><a href="#3-2实例" class="headerlink" title="3.2实例"></a>3.2实例</h2><ul>
<li>for循环的是可迭代对象, 首先通过__iter__得到一个迭代器, 然后不断调用迭代器的__next__, 但是如果对象没有实现 __iter__或__next__迭代器协议，Python的解释器就会去寻找__getitem__来迭代对象，如果连__getitem__都没有定义，这解释器就会报对象不是可迭代对象的错误.</li>
<li>魔法函数是能影响到语法本身的, 本来company是无法进行切片操作, 但是由于实现了__getitem__, 所以在python的语法上我们可以对实例化的对象进行切片操作.(列表也是list这个类实例化得到的一个对象)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Company</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, employee__list</span>):</span><br><span class="line">        self.employee = employee__list</span><br><span class="line">    <span class="comment"># item将传入0、1、2...</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">return</span> self.employee[item]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.employee)</span><br><span class="line"></span><br><span class="line">company = Company([<span class="string">&quot;tom&quot;</span>, <span class="string">&quot;bob&quot;</span>, <span class="string">&quot;jane&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> em <span class="keyword">in</span> company:  <span class="comment"># __getitem__</span></span><br><span class="line">    <span class="built_in">print</span>(em)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> em <span class="keyword">in</span> company[<span class="number">1</span>:]:  <span class="comment"># __getitem__</span></span><br><span class="line">    <span class="built_in">print</span>(em)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(company))  <span class="comment"># __len__</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3常用魔法函数-非数学运算类型"><a href="#3-3常用魔法函数-非数学运算类型" class="headerlink" title="3.3常用魔法函数(非数学运算类型)"></a>3.3常用魔法函数(非数学运算类型)</h2><h3 id="字符串表示"><a href="#字符串表示" class="headerlink" title="字符串表示"></a>字符串表示</h3><ul>
<li><strong>repr</strong></li>
<li><strong>str</strong></li>
</ul>
<h3 id="集合序列相关"><a href="#集合序列相关" class="headerlink" title="集合序列相关"></a>集合序列相关</h3><ul>
<li><strong>len</strong></li>
<li><strong>getitem</strong></li>
<li><strong>setitem</strong></li>
<li><strong>delitem</strong></li>
<li><strong>contains</strong></li>
</ul>
<h3 id="迭代相关"><a href="#迭代相关" class="headerlink" title="迭代相关"></a>迭代相关</h3><ul>
<li><strong>iter</strong></li>
<li><strong>next</strong></li>
</ul>
<h3 id="可调用"><a href="#可调用" class="headerlink" title="可调用"></a>可调用</h3><ul>
<li><strong>call</strong></li>
</ul>
<h3 id="with上下文管理器"><a href="#with上下文管理器" class="headerlink" title="with上下文管理器"></a>with上下文管理器</h3><ul>
<li><strong>enter</strong></li>
<li><strong>exit</strong></li>
</ul>
<h3 id="数值转换"><a href="#数值转换" class="headerlink" title="数值转换"></a>数值转换</h3><ul>
<li><strong>abs</strong></li>
<li><strong>bool</strong></li>
<li><strong>int</strong></li>
<li><strong>float</strong></li>
<li><strong>hash</strong></li>
<li><strong>index</strong></li>
</ul>
<h3 id="元类相关"><a href="#元类相关" class="headerlink" title="元类相关"></a>元类相关</h3><ul>
<li><strong>new</strong></li>
<li><strong>init</strong></li>
</ul>
<h3 id="属性相关"><a href="#属性相关" class="headerlink" title="属性相关"></a>属性相关</h3><ul>
<li><strong>getattr</strong></li>
<li><strong>setattr</strong></li>
<li><strong>getattribute</strong></li>
<li><strong>setattribute</strong></li>
<li><strong>dir</strong></li>
</ul>
<h3 id="属性描述符"><a href="#属性描述符" class="headerlink" title="属性描述符"></a>属性描述符</h3><ul>
<li><strong>get</strong></li>
<li><strong>set</strong></li>
<li><strong>delete</strong></li>
</ul>
<h3 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h3><ul>
<li><strong>await</strong></li>
<li><strong>aiter</strong></li>
<li><strong>anext</strong></li>
<li><strong>aenter</strong></li>
<li><strong>aexit</strong></li>
</ul>
<h2 id="3-4常用魔法函数-数学运算类型"><a href="#3-4常用魔法函数-数学运算类型" class="headerlink" title="3.4常用魔法函数(数学运算类型)"></a>3.4常用魔法函数(数学运算类型)</h2><h3 id="一元运算符"><a href="#一元运算符" class="headerlink" title="一元运算符"></a>一元运算符</h3><ul>
<li>__neg__（-）</li>
<li>__pos__（+）</li>
<li><strong>abs</strong></li>
</ul>
<h3 id="二元运算符"><a href="#二元运算符" class="headerlink" title="二元运算符"></a>二元运算符</h3><ul>
<li><strong>lt</strong>(&lt;)</li>
<li><strong>le</strong> &lt;&#x3D;</li>
<li><strong>eq</strong> &#x3D;&#x3D;</li>
<li><strong>ne</strong> !&#x3D;</li>
<li><strong>gt</strong> &gt;</li>
<li><strong>ge</strong> &gt;&#x3D;</li>
</ul>
<h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><ul>
<li><strong>add</strong> +</li>
<li><strong>sub</strong> -</li>
<li><strong>mul</strong> *</li>
<li><strong>truediv</strong> &#x2F;</li>
<li><strong>floordiv</strong> &#x2F;&#x2F;</li>
<li><strong>mod</strong> %</li>
<li><strong>divmod</strong> 或 divmod()</li>
<li><strong>pow</strong> 或 ** 或 pow()</li>
<li><strong>round</strong> 或 round()</li>
</ul>
<h3 id="反向算术运算符"><a href="#反向算术运算符" class="headerlink" title="反向算术运算符"></a>反向算术运算符</h3><ul>
<li><strong>radd</strong></li>
<li><strong>rsub</strong></li>
<li><strong>rmul</strong></li>
<li><strong>rtruediv</strong></li>
<li><strong>rfloordiv</strong></li>
<li><strong>rmod</strong></li>
<li><strong>rdivmod</strong></li>
<li><strong>rpow</strong></li>
</ul>
<h3 id="增量赋值算术运算符"><a href="#增量赋值算术运算符" class="headerlink" title="增量赋值算术运算符"></a>增量赋值算术运算符</h3><ul>
<li><strong>iadd</strong></li>
<li><strong>isub</strong></li>
<li><strong>imul</strong></li>
<li><strong>itruediv</strong></li>
<li><strong>ifloordiv</strong></li>
<li><strong>imod</strong></li>
<li><strong>ipow</strong></li>
</ul>
<h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><ul>
<li><strong>invert</strong> ~</li>
<li><strong>lshift</strong> &lt;&lt;</li>
<li><strong>rshift</strong> &gt;&gt;</li>
<li><strong>and</strong> &amp;</li>
<li><strong>or</strong> |</li>
<li><strong>xor</strong> ^</li>
</ul>
<h3 id="反向位运算符"><a href="#反向位运算符" class="headerlink" title="反向位运算符"></a>反向位运算符</h3><ul>
<li><strong>rlshift</strong></li>
<li><strong>rrshift</strong></li>
<li><strong>rand</strong></li>
<li><strong>rxor</strong></li>
<li><strong>ror</strong></li>
</ul>
<h3 id="增量赋值位运算符"><a href="#增量赋值位运算符" class="headerlink" title="增量赋值位运算符"></a>增量赋值位运算符</h3><ul>
<li><strong>ilshift</strong></li>
<li><strong>irshift</strong></li>
<li><strong>iand</strong></li>
<li><strong>ixor</strong></li>
<li><strong>ior</strong></li>
</ul>
<h3 id="字符串表示-1"><a href="#字符串表示-1" class="headerlink" title="字符串表示"></a>字符串表示</h3><ul>
<li><strong>str</strong></li>
</ul>
<p>在打印一个实例化对象的时候, python默认会调用str(对象), 对应的魔法函数是__str__</p>
<ul>
<li><strong>repr</strong></li>
</ul>
<p>__repr__是在开发模式下调用的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Company</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, employee__list</span>):</span><br><span class="line">        self.employee = employee__list</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;,&#x27;</span>.join(self.employee)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span>.join(self.employee)</span><br><span class="line"></span><br><span class="line">company = Company([<span class="string">&quot;tom&quot;</span>, <span class="string">&quot;bob&quot;</span>, <span class="string">&quot;jane&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(company) <span class="comment"># str 输出</span></span><br><span class="line">company        <span class="comment"># repr输出</span></span><br><span class="line"></span><br><span class="line">tom,bob,jane   <span class="comment"># 打印对象</span></span><br><span class="line">tom.bob.jane   <span class="comment"># 调试模式</span></span><br></pre></td></tr></table></figure>

<h2 id="3-5len函数"><a href="#3-5len函数" class="headerlink" title="3.5len函数"></a>3.5len函数</h2><p>之前提到len函数式会调用对象的__len__, 如果是使用遍历的方式求长度那么效率会很低, 但是在求python内置类型的长度比如len(list)、len(dict)、len(set)等的时候会很快, 因为在<strong>cpython中的list、dict、set</strong>等是通过c语言实现的, 在其内部会维护一个数据表示长度,所以就不需要进行遍历,能大大提高效率, 所以尽量使用python原生的数据类型。</p>
<h1 id="4、深入类和对象"><a href="#4、深入类和对象" class="headerlink" title="4、深入类和对象"></a>4、<strong>深入类和对象</strong></h1><h2 id="4-1鸭子类型和多态"><a href="#4-1鸭子类型和多态" class="headerlink" title="4.1鸭子类型和多态"></a>4.1<strong>鸭子类型和多态</strong></h2><h3 id="鸭子类型"><a href="#鸭子类型" class="headerlink" title="鸭子类型"></a><strong>鸭子类型</strong></h3><p>当看到一只鸟走起来像鸭子、游泳起来像鸭子、叫起来也像鸭子, 那么这只鸟就可以被称为鸭子.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;i am a cat&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;i am a fish&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Duck</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;i am a duck&quot;</span>)</span><br><span class="line"></span><br><span class="line">animal_list = [Cat, Dog, Duck] <span class="comment"># 类也是对象, 可以被添加到列表中, 而且python是动态语言, 对于变量不需要指定类型</span></span><br><span class="line"><span class="keyword">for</span> animal <span class="keyword">in</span> animal_list:</span><br><span class="line">    animal().say()</span><br></pre></td></tr></table></figure>

<h3 id="列表的extend"><a href="#列表的extend" class="headerlink" title="列表的extend"></a>列表的extend</h3><p>list.extend() 因为传入的只需要是iterable类型即可, 所以list可以扩展tuple、set等都可以. 或者我们实现一个类可以迭代,也可以放到extend中.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Company</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, employee_list</span>):</span><br><span class="line">        self.employee = employee_list</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):   <span class="comment"># 可迭代</span></span><br><span class="line">        <span class="keyword">return</span> self.employee[item]</span><br><span class="line"></span><br><span class="line">company = Company([<span class="string">&quot;tom&quot;</span>, <span class="string">&quot;bob&quot;</span>, <span class="string">&quot;jane&quot;</span>])</span><br><span class="line"></span><br><span class="line">a = [<span class="string">&quot;bobby1&quot;</span>, <span class="string">&quot;bobby2&quot;</span>]</span><br><span class="line"></span><br><span class="line">a.extend(company)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>

<p>我们在几个对象中都实现了某一个方法名, 这些类我们就可以通用, 比如上面的say和__getitem__, 而魔法函数也是利用的python的<strong>鸭子类型</strong>, 只要实现了__getitem__就可迭代, 就可以传入extend中.</p>
<h2 id="4-2抽象基类-abc模块"><a href="#4-2抽象基类-abc模块" class="headerlink" title="4.2抽象基类(abc模块)"></a>4.2<strong>抽象基类(abc模块)</strong></h2><h3 id="抽象基类"><a href="#抽象基类" class="headerlink" title="抽象基类"></a>抽象基类</h3><ul>
<li>抽象基类是一个虚拟的类, 相当于一个模板, 定义一些方法, 所有继承这个基类的类必须覆盖抽象基类里面的方法</li>
<li>抽象基类是无法用来实例化的</li>
</ul>
<h3 id="为什么要有抽象基类"><a href="#为什么要有抽象基类" class="headerlink" title="为什么要有抽象基类"></a>为什么要有抽象基类</h3><p>因为python是基于鸭子类型的, 所以其实只要实现某些方法就可以了, 那为什么还要抽象基类呢?</p>
<ul>
<li>第一种用法:我们去检查某个类是否有某一种方法</li>
</ul>
<p>某些情况之下希望判定某个对象的类型, 可以使用<code>hasattr</code>判断是否实现某方法或者使用<code>isinstance</code>(推荐)去判断一个类是否是指定的类型, <code>Sized</code>就是一个实现<code>__len__</code>的抽象基类.</p>
<ul>
<li>第二种用法: 强制某个子类必须实现某些方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟抽象基类, 只有在调用set方法的时候才会抛出异常</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CacheBase</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="keyword">raise</span> NotImplementedError</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RedisCache</span>(<span class="title class_ inherited__">CacheBase</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">redis_cache = RedisCache()</span><br><span class="line">redis_cache.<span class="built_in">set</span>(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用abc模块, 在初始化的时候就会去判断有没有重载基类的方法,没有就抛异常</span></span><br><span class="line"><span class="keyword">import</span> abc</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CacheBase</span>(metaclass=abc.ABCMeta):</span><br><span class="line"><span class="meta">    @abc.abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abc.abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RedisCache</span>(<span class="title class_ inherited__">CacheBase</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">redis_cache = RedisCache()</span><br></pre></td></tr></table></figure>

<h3 id="collection-abc模块"><a href="#collection-abc模块" class="headerlink" title="collection.abc模块"></a>collection.abc模块</h3><p>在这个模块中定义了很多通用的抽象基类, 比如Sized. 但是这些抽象基类定义出来并不是用来继承的, 更多的是让我们理解接口的一些定义. 推荐使用鸭子类型或者多继承(Mixin)实现, 而少用抽象基类.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__all__ = [<span class="string">&quot;Awaitable&quot;</span>, <span class="string">&quot;Coroutine&quot;</span>,</span><br><span class="line">           <span class="string">&quot;AsyncIterable&quot;</span>, <span class="string">&quot;AsyncIterator&quot;</span>, <span class="string">&quot;AsyncGenerator&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Hashable&quot;</span>, <span class="string">&quot;Iterable&quot;</span>, <span class="string">&quot;Iterator&quot;</span>, <span class="string">&quot;Generator&quot;</span>, <span class="string">&quot;Reversible&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sized&quot;</span>, <span class="string">&quot;Container&quot;</span>, <span class="string">&quot;Callable&quot;</span>, <span class="string">&quot;Collection&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Set&quot;</span>, <span class="string">&quot;MutableSet&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Mapping&quot;</span>, <span class="string">&quot;MutableMapping&quot;</span>,</span><br><span class="line">           <span class="string">&quot;MappingView&quot;</span>, <span class="string">&quot;KeysView&quot;</span>, <span class="string">&quot;ItemsView&quot;</span>, <span class="string">&quot;ValuesView&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sequence&quot;</span>, <span class="string">&quot;MutableSequence&quot;</span>,</span><br><span class="line">           <span class="string">&quot;ByteString&quot;</span>,</span><br><span class="line">           ]</span><br></pre></td></tr></table></figure>

<h3 id="声明抽象基类"><a href="#声明抽象基类" class="headerlink" title="声明抽象基类"></a>声明抽象基类</h3><ul>
<li>metaclass &#x3D; abc.ABCMeta</li>
<li>@abc.abstractmethod</li>
</ul>
<h2 id="4-3isinstance和type的区别"><a href="#4-3isinstance和type的区别" class="headerlink" title="4.3isinstance和type的区别"></a><strong>4.3isinstance和type的区别</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">b = B()</span><br><span class="line"></span><br><span class="line"><span class="comment"># instance用于判断一个对象是否是已知类型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">isinstance</span>(b, B)) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">isinstance</span>(b, A)) <span class="comment"># True isinstance会根据继承链去判断</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 求一个未知数据类型的对象</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b)) <span class="comment"># &lt;class &#x27;__main__.B&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># type不认为子类是父类的一种类型，isinstance认为子类是父类的一种类型，即子类对象也属于父类类型.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># is是去判断这两个是不是一个对象, 即id是否相同</span></span><br><span class="line"><span class="comment"># ==是判断值是否相等</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b) <span class="keyword">is</span> B) <span class="comment"># True 得到的是B的地址</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(b) <span class="keyword">is</span> A) <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(B)) <span class="comment"># 1943999460392</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(<span class="built_in">type</span>(b))) <span class="comment"># 1943999460392</span></span><br><span class="line"><span class="built_in">print</span>(B) <span class="comment"># &lt;class &#x27;__main__.B&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">c=a</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a)) <span class="comment"># 2065494827720</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b)) <span class="comment"># 2065493557192</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(c)) <span class="comment"># 2065494827720</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b) <span class="comment"># False</span></span><br><span class="line"><span class="built_in">print</span>(c <span class="keyword">is</span> a) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>((a==b)) <span class="comment"># True </span></span><br></pre></td></tr></table></figure>

<h2 id="4-4类变量和实例变量"><a href="#4-4类变量和实例变量" class="headerlink" title="4.4类变量和实例变量"></a>4.4<strong>类变量和实例变量</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    aa = <span class="number">1</span> <span class="comment"># 类变量</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, x, y</span>):</span><br><span class="line">        self.x = x <span class="comment"># 实例变量</span></span><br><span class="line">        self.y = y</span><br><span class="line"></span><br><span class="line">a = A(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">A.aa = <span class="number">11</span> <span class="comment"># 会将类A内存中的的aa修改为11</span></span><br><span class="line">a.aa = <span class="number">22</span> <span class="comment"># 会在实例a内存中创建一个变量aa赋值22, 类A内存中的aa还是11</span></span><br><span class="line"><span class="built_in">print</span>(a.x, a.y, a.aa) <span class="comment"># a.aa首先会去实例a的内存中找是否有aa, 如果没有再去类A的内存中找</span></span><br><span class="line"><span class="built_in">print</span>(A.aa) <span class="comment"># 去类A的内存中找aa, 值为11</span></span><br><span class="line"></span><br><span class="line">b = A(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(b.aa) <span class="comment"># 类A内存中aa已经修改为11</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> <span class="number">3</span> <span class="number">22</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">11</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">11</span></span><br></pre></td></tr></table></figure>

<h2 id="4-5类和实例属性的查找顺序—mro查找"><a href="#4-5类和实例属性的查找顺序—mro查找" class="headerlink" title="4.5类和实例属性的查找顺序—mro查找"></a><strong>4.5类和实例属性的查找顺序—mro查找</strong></h2><h3 id="MRO算法"><a href="#MRO算法" class="headerlink" title="MRO算法"></a>MRO算法</h3><p><strong>为什么不单纯使用深度优先或者广度优先</strong></p>
<ul>
<li>深度优先搜寻</li>
</ul>
<p>查找顺序是A-&gt;B-&gt;D-&gt;C, 但是如果C重载了D的某个方法(B没有重载该方法), 由于深度优先所以将会使用D中的方法, 这是不合理的</p>
<p><img src="image-20210518194759876.png" alt="image-20210518194759876"></p>
<ul>
<li>广度优先</li>
</ul>
<p>查找顺序是A-&gt;B-&gt;C-&gt;D-&gt;E, 由于优先级关系, B和D的优先级高于C, 但是如果C和D中定义了同一个方法, 由于广度优先所以将会使用C中的方法, 这是不合理的</p>
<p><img src="image-20210518194932922.png" alt="image-20210518194932922"></p>
<h3 id="C3算法"><a href="#C3算法" class="headerlink" title="C3算法"></a>C3算法</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">E</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">E</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">D</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(B, C):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(A.__mro__)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.A&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.D&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.C&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.E&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">D</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">D</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(B, C):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(A.__mro__)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.A&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.C&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.D&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure>

<ul>
<li>MRO是一个<strong>有序列表</strong>L，在类被创建时就计算出来。</li>
<li>通用计算公式为:</li>
</ul>
<p> <code>mro(Child(Base1，Base2)) = [ Child ] + merge( mro(Base1), mro(Base2),  [ Base1, Base2] ) （其中Child继承自Base1, Base2）</code></p>
<ul>
<li>如果继承至一个基类：class B(A). 这时B的mro序列为:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mro( B ) = mro( B(A) )</span><br><span class="line">= [B] + merge( mro(A) + [A] )</span><br><span class="line">= [B] + merge( [A] + [A] )</span><br><span class="line">= [B,A]</span><br></pre></td></tr></table></figure>

<ul>
<li>如果继承至多个基类：class B(A1, A2, A3 …). 这时B的mro序列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mro(B)  = mro( B(A1, A2, A3 …) )</span><br><span class="line">= [B] + merge( mro(A1), mro(A2), mro(A3) ..., [A1, A2, A3] )</span><br><span class="line">= ...</span><br></pre></td></tr></table></figure>

<ul>
<li><p>计算结果为列表，列表中至少有一个元素即类自己，如上述示例[A1,A2,A3]。merge操作是C3算法的核心。</p>
</li>
<li><p><strong>表头：</strong><br>列表的第一个元素</p>
</li>
<li><p><strong>表尾：</strong><br>列表中表头以外的元素集合（可以为空）</p>
</li>
</ul>
<p>merge操作示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">如计算merge( [E,O], [C,E,F,O], [C] )</span><br><span class="line">有三个列表 ：  ①      ②          ③</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> merge不为空，取出第一个列表列表①的表头E，进行判断                              </span><br><span class="line">各个列表的表尾分别是[O], [E,F,O]，E在这些表尾的集合中，因而跳过当前当前列表</span><br><span class="line"><span class="number">2</span> 取出列表②的表头C，进行判断</span><br><span class="line">C不在各个列表的集合中，因而将C拿出到merge外，并从所有表头删除</span><br><span class="line">merge( [E,O], [C,E,F,O], [C]) = [C] + merge( [E,O], [E,F,O] )</span><br><span class="line"><span class="number">3</span> 进行下一次新的merge操作 ......</span><br></pre></td></tr></table></figure>

<h2 id="4-6类方法、静态方法和实例方法"><a href="#4-6类方法、静态方法和实例方法" class="headerlink" title="4.6类方法、静态方法和实例方法"></a><strong>4.6类方法、静态方法和实例方法</strong></h2><h3 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h3><ul>
<li>可以访问实例变量和类变量</li>
<li>只能实例对象调用</li>
</ul>
<h3 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h3><ul>
<li>@staticmethod</li>
<li>静态方法是<strong>不可以访问实例变量或类变量</strong>,不会主动传入self,传入什么参数才能获取到什么参数.</li>
<li><strong>可通过实例对象或类对象调用</strong></li>
</ul>
<h3 id="类方法"><a href="#类方法" class="headerlink" title="类方法"></a>类方法</h3><ul>
<li>@classmethod</li>
<li>类方法只能访问类变量，不能访问实例变量</li>
<li>可通过实例对象或类对象调用</li>
<li>需要传入cls参数, <strong>cls参数指向的是一开始定义的类对象</strong>（不是实例对象）</li>
</ul>
<h3 id="对比"><a href="#对比" class="headerlink" title="对比"></a>对比</h3><ol>
<li>类方法无须创建实例对象调用，所以类方法的调用较实例方法更为灵活</li>
<li>静态方法有点像附属于类对象的“工具”, 将对象的相关处理逻辑“束缚”在对象体内，这样封装得会更好些。</li>
<li>实例方法只能通过实例对象调用；类方法和静态方法可以通过类对象或者实例对象调用，如果是使用实例对象调用的类方法或静态方法，最终都会转而通过类对象调用。</li>
<li>实例方法使用最多，可以直接处理实例对象的逻辑；类方法不需要创建实例对象，直接处理类对象的逻辑；静态方法将与类对象相关的某些逻辑抽离出来，不仅可以用于测试，还能便于代码后期维护。</li>
<li>实例方法和类方法，能够改变实例对象或类对象的状态，而静态方法不能。</li>
</ol>
<h2 id="4-7数据封装和私有属性"><a href="#4-7数据封装和私有属性" class="headerlink" title="4.7数据封装和私有属性"></a><strong>4.7数据封装和私有属性</strong></h2><h3 id="私有属性"><a href="#私有属性" class="headerlink" title="私有属性"></a>私有属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 类中所有双下划线开头的名称如__x都会在类定义时自动变形成：_类名__x的形式</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    __N = <span class="number">0</span></span><br><span class="line">    _M = <span class="number">1</span>   <span class="comment"># 可以在外部调用, 只是给程序员提示</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.__N = <span class="number">10</span>  <span class="comment"># _A__N</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">read</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(self.__N)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__write</span>(<span class="params">self</span>): <span class="comment"># _A__write</span></span><br><span class="line">        self.__N = <span class="number">20</span></span><br><span class="line">        <span class="built_in">print</span>(self.__N)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">write</span>(<span class="params">self</span>):</span><br><span class="line">        self.__write() <span class="comment"># 可以在内部调用</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(A))</span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(a._M)</span><br><span class="line">a.read()</span><br><span class="line"><span class="comment"># a.__write() # 无法调用</span></span><br><span class="line">a.write()</span><br><span class="line"><span class="built_in">print</span>(a._A__N) <span class="comment"># 可以调用</span></span><br><span class="line">a._A__write() <span class="comment"># 可以调用</span></span><br><span class="line"></span><br><span class="line">[<span class="string">&#x27;_A__N&#x27;</span>, <span class="string">&#x27;_A__write&#x27;</span>, <span class="string">&#x27;_M&#x27;</span>, <span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__init_subclass__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__module__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;read&#x27;</span>, <span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">20</span></span><br></pre></td></tr></table></figure>

<h2 id="4-8python对象的自省机制"><a href="#4-8python对象的自省机制" class="headerlink" title="4.8python对象的自省机制."></a><strong>4.8python对象的自省机制.</strong></h2><p>自省是通过一定的机制查询到对象的内部机制, <strong>编程中，自省的能力：检查某些事物以确定它是什么，它知道什么以及它能做什么。</strong></p>
<ul>
<li>__dict__返回的是字典, dir返回的是列表</li>
<li>__dict__查看<strong>对象</strong>的所有属性(可写属性), dir查看<strong>类本身</strong>的所有属性。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    name = <span class="string">&quot;Person_name&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">Person</span>):</span><br><span class="line">    student_name = <span class="string">&#x27;student_name&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, school_name</span>):</span><br><span class="line">        self.school_name = school_name</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    user = Student(<span class="string">&quot;慕课网&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(user.__dict__) <span class="comment"># 通过__dict__查询属性</span></span><br><span class="line">    <span class="built_in">print</span>(user.name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过user.name可以读取到, 但是通过__dict__无法获取的原因 </span></span><br><span class="line">    <span class="comment"># name是属于Person的属性, 并不是Student的属性, 但是使用点的时候会向上查找.</span></span><br><span class="line">    &gt;&gt;&gt; &#123;<span class="string">&#x27;school_name&#x27;</span>: <span class="string">&#x27;慕课网&#x27;</span>&#125;</span><br><span class="line">    &gt;&gt;&gt; Person_name</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(Student.__dict__)</span><br><span class="line">    <span class="built_in">print</span>(Person.__dict__)</span><br><span class="line">    &gt;&gt;&gt; &#123;<span class="string">&#x27;__module__&#x27;</span>: <span class="string">&#x27;__main__&#x27;</span>, <span class="string">&#x27;student_name&#x27;</span>: <span class="string">&#x27;student_name&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>: &lt;function Student.__init__ at <span class="number">0x00000269CCA83620</span>&gt;, <span class="string">&#x27;__doc__&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line">    &gt;&gt;&gt; &#123;<span class="string">&#x27;__module__&#x27;</span>: <span class="string">&#x27;__main__&#x27;</span>, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Person_name&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>: &lt;attribute <span class="string">&#x27;__dict__&#x27;</span> of <span class="string">&#x27;Person&#x27;</span> objects&gt;, <span class="string">&#x27;__weakref__&#x27;</span>: &lt;attribute <span class="string">&#x27;__weakref__&#x27;</span> of <span class="string">&#x27;Person&#x27;</span> objects&gt;, <span class="string">&#x27;__doc__&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过__dict__赋值</span></span><br><span class="line">    user.__dict__[<span class="string">&quot;school_addr&quot;</span>] = <span class="string">&quot;北京市&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(user.school_addr)</span><br><span class="line">    &gt;&gt;&gt; 北京市</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过dir查询属性(只有属性名称)</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">dir</span>(user))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">dir</span>(Student))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">dir</span>(Person))</span><br><span class="line">    <span class="comment"># 公共部分</span></span><br><span class="line">    &gt;&gt;&gt; [<span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__init_subclass__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__module__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;__weakref__&#x27;</span>, ]</span><br><span class="line">    <span class="comment"># 不同部分</span></span><br><span class="line">    &gt;&gt;&gt; ...<span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;school_name&#x27;</span>, <span class="string">&#x27;student_name&#x27;</span>]</span><br><span class="line">    &gt;&gt;&gt; ...<span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;student_name&#x27;</span>]</span><br><span class="line">    &gt;&gt;&gt; ...<span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;name&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h3 id="bases-和issubclass"><a href="#bases-和issubclass" class="headerlink" title="__bases__和issubclass"></a>__bases__和issubclass</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">B</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(C.__bases__)  <span class="comment"># (&lt;class &#x27;__main__.B&#x27;&gt;,)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">issubclass</span>(C,B)) <span class="comment"># True</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">issubclass</span>(C,A)) <span class="comment"># True</span></span><br></pre></td></tr></table></figure>

<h2 id="4-9super真的是调用父类吗"><a href="#4-9super真的是调用父类吗" class="headerlink" title="4.9super真的是调用父类吗"></a><strong>4.9super真的是调用父类吗</strong></h2><h3 id="super真正调用的是什么"><a href="#super真正调用的是什么" class="headerlink" title="super真正调用的是什么?"></a>super真正调用的是什么?</h3><p>&#x3D;&#x3D;super真正调用的是MRO中的下一个类的函数&#x3D;&#x3D;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;A&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;B&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>(<span class="title class_ inherited__">A</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;C&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">        </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">D</span>(B, C):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;D&quot;</span>)</span><br><span class="line">        <span class="built_in">super</span>(D, self).__init__()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(D.__mro__)</span><br><span class="line">    d = D()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.D&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.B&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.C&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.A&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br><span class="line">D</span><br><span class="line">B</span><br><span class="line">C</span><br><span class="line">A</span><br></pre></td></tr></table></figure>

<h2 id="4-10mixin继承案例-django-rest-framework"><a href="#4-10mixin继承案例-django-rest-framework" class="headerlink" title="4.10mixin继承案例-django rest framework"></a><strong>4.10mixin继承案例-django rest framework</strong></h2><h3 id="Mixin类"><a href="#Mixin类" class="headerlink" title="Mixin类"></a>Mixin类</h3><ul>
<li>Python是支持多继承的。我们可以利用 Python 的这种特性，实现一种叫做 Mixin 的类</li>
<li><strong>Mixin 类只包含了一组特定的函数集合，而我们将会将其与其他类进行混合，从而生成一个适用于实际需要的新类</strong></li>
</ul>
<h3 id="Mixin模式特点"><a href="#Mixin模式特点" class="headerlink" title="Mixin模式特点"></a>Mixin模式特点</h3><ol>
<li>Mixin类功能单一</li>
<li>不和基类关联，可以和任意基类组合， 基类可以不和mixin关联就能初始化成功</li>
<li>在mixin中不要使用super这种用法</li>
</ol>
<h2 id="4-11python中的with语句"><a href="#4-11python中的with语句" class="headerlink" title="4.11python中的with语句"></a><strong>4.11python中的with语句</strong></h2><h3 id="上下文管理器"><a href="#上下文管理器" class="headerlink" title="上下文管理器"></a>上下文管理器</h3><p>异常捕捉中的return</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">exe_try</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;code started&quot;</span>)</span><br><span class="line">        <span class="keyword">raise</span> KeyError</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> <span class="comment"># 不会被执行</span></span><br><span class="line">    <span class="keyword">except</span> KeyError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;key error&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span> <span class="comment"># 压入堆栈</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no error&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">3</span></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;finally&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">4</span> <span class="comment"># 压入堆栈, 最后取出栈顶</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(exe_try())</span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line">    code started</span><br><span class="line">    key error</span><br><span class="line">    <span class="keyword">finally</span></span><br><span class="line">    <span class="number">4</span>  <span class="comment"># 不是输出2, 而是4</span></span><br></pre></td></tr></table></figure>

<p>上下文管理器协议</p>
<ul>
<li>&#x3D;&#x3D;with语句后面的as得到的是__enter__方法的返回值&#x3D;&#x3D;, 如果<code>__enter__</code>返回1, 那么sample就等于1.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Sample</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 获取资源</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;enter&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span><br><span class="line">        <span class="comment">#释放资源</span></span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;exit&quot;</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_something</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;doing something&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Sample() <span class="keyword">as</span> sample:</span><br><span class="line">    sample.do_something()</span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line">    enter</span><br><span class="line">    doing something</span><br><span class="line">    exit</span><br></pre></td></tr></table></figure>

<ul>
<li>如果<code>__enter__</code>没有返回值, 那么无法使用as.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):  <span class="comment"># 获取资源</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;enter&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):  <span class="comment"># 释放资源</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;exit&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">said</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;said&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> Person() <span class="keyword">as</span> P:</span><br><span class="line">    P.said()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>AttributeError: <span class="string">&#x27;NoneType&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;said&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-12-contextlib简化上下文管理器"><a href="#4-12-contextlib简化上下文管理器" class="headerlink" title="4.12 contextlib简化上下文管理器"></a>4.12 <strong>contextlib简化上下文管理器</strong></h2><p><strong>contextmanager可以简化上下文管理器</strong>，不需要我们编写<code>__enter__</code>和<code>__exit__</code>函数。他给了我们一个机会，让我们把之前一个不是上下文管理器的类变成一个上下文管理器，而不需要我们去修改这个类的源代码.</p>
<p>其中的yield的作用，是<strong>中断当前函数执行流程，先去执行yield出去的部分的代码执行流程</strong>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> contextlib</span><br><span class="line"></span><br><span class="line"><span class="meta">@contextlib.contextmanager</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_open</span>(<span class="params">file_name</span>):</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;file open&quot;</span>)</span><br><span class="line">    <span class="keyword">yield</span> </span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;file end&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> file_open(<span class="string">&quot;bobby.txt&quot;</span>) <span class="keyword">as</span> f_opened:</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;file processing&quot;</span>)</span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line">    file <span class="built_in">open</span></span><br><span class="line">    file processing</span><br><span class="line">    file end</span><br></pre></td></tr></table></figure>

<h1 id="5、自定义序列类"><a href="#5、自定义序列类" class="headerlink" title="5、自定义序列类"></a><strong>5、自定义序列类</strong></h1><h2 id="5-1python中的序列分类"><a href="#5-1python中的序列分类" class="headerlink" title="5.1python中的序列分类"></a><strong>5.1python中的序列分类</strong></h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储数据类型区别</span></span><br><span class="line">**容器序列**</span><br><span class="line">	<span class="built_in">list</span>, <span class="built_in">tuple</span>, deque</span><br><span class="line">**扁平序列**</span><br><span class="line">	<span class="built_in">str</span>, <span class="built_in">bytes</span>, <span class="built_in">bytearray</span>, array.array</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变性</span></span><br><span class="line">**可变序列**</span><br><span class="line">	<span class="built_in">list</span>, deque, <span class="built_in">bytearray</span>, array</span><br><span class="line">**不可变序列**</span><br><span class="line">	<span class="built_in">str</span>, <span class="built_in">tuple</span>, <span class="built_in">bytes</span></span><br></pre></td></tr></table></figure>

<ul>
<li>容器序列(可以放置任意类型数据)</li>
<li>扁平序列</li>
</ul>
<h2 id="5-2python中序列类型的abc继承关系"><a href="#5-2python中序列类型的abc继承关系" class="headerlink" title="5.2python中序列类型的abc继承关系"></a><strong>5.2python中序列类型的abc继承关系</strong></h2><h3 id="序列类型的协议"><a href="#序列类型的协议" class="headerlink" title="序列类型的协议"></a>序列类型的协议</h3><p>和容器相关的数据结构的抽象基类都在<code>from collections import abc</code>这个模块，我们打开<code>from _collections_abc import all</code>，在<code>_collections_abc.py</code>模块里面可以看到内容如下：p</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__all__ = [<span class="string">&quot;Awaitable&quot;</span>, <span class="string">&quot;Coroutine&quot;</span>,</span><br><span class="line">           <span class="string">&quot;AsyncIterable&quot;</span>, <span class="string">&quot;AsyncIterator&quot;</span>, <span class="string">&quot;AsyncGenerator&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Hashable&quot;</span>, <span class="string">&quot;Iterable&quot;</span>, <span class="string">&quot;Iterator&quot;</span>, <span class="string">&quot;Generator&quot;</span>, <span class="string">&quot;Reversible&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sized&quot;</span>, <span class="string">&quot;Container&quot;</span>, <span class="string">&quot;Callable&quot;</span>, <span class="string">&quot;Collection&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Set&quot;</span>, <span class="string">&quot;MutableSet&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Mapping&quot;</span>, <span class="string">&quot;MutableMapping&quot;</span>,</span><br><span class="line">           <span class="string">&quot;MappingView&quot;</span>, <span class="string">&quot;KeysView&quot;</span>, <span class="string">&quot;ItemsView&quot;</span>, <span class="string">&quot;ValuesView&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sequence&quot;</span>, <span class="string">&quot;MutableSequence&quot;</span>,</span><br><span class="line">           <span class="string">&quot;ByteString&quot;</span>,</span><br><span class="line">           ]</span><br></pre></td></tr></table></figure>

<p>咱们只需要关注“Sequence”, “MutableSequence”, Sequence 是不可变序列类型，MutableSequence 是可变序列类型.</p>
<h3 id="Sequence"><a href="#Sequence" class="headerlink" title="Sequence"></a>Sequence</h3><p><strong>Sequence 继承的类</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 继承了两个类 Reversible, Collection</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sequence</span>(Reversible, Collection):</span><br><span class="line">    <span class="comment"># 抽象方法的标识，如果用他必须重写这个方法    </span></span><br><span class="line"><span class="meta">    @abstractmethod </span></span><br></pre></td></tr></table></figure>

<p>Reversible是序列的翻转，例如ABC变成CBA</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Collection</span>(Sized, Iterable, Container):   </span><br><span class="line">    <span class="comment"># Sized里面有魔法函数__len__,可以计算序列的长度</span></span><br><span class="line">    <span class="comment"># Iterable是个迭代对象, 有了它可以进行for循环</span></span><br><span class="line">    <span class="comment"># Container里面有魔法函数__contains__，我们就可以用in这个字段，例如 if i in list()   </span></span><br><span class="line"></span><br><span class="line">    __slots__ = ()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__subclasshook__</span>(<span class="params">cls, C</span>):</span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">is</span> Collection:</span><br><span class="line">            <span class="keyword">return</span> _check_methods(C,  <span class="string">&quot;__len__&quot;</span>, <span class="string">&quot;__iter__&quot;</span>, <span class="string">&quot;__contains__&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NotImplemented</span></span><br></pre></td></tr></table></figure>

<p>Sequence的所有魔法函数构成了序列的协议, 打开Sequence类我们可以看到里面重写了所继承的抽象基类的方法,包括<code>__len__</code>,<code>__iter__</code>和<code>__contains__</code>.</p>
<h3 id="MutableSequence"><a href="#MutableSequence" class="headerlink" title="MutableSequence"></a>MutableSequence</h3><p>MutableSequence是<strong>可变的序列</strong>, 他继承了Sequence并新加了一些特性. 如 setitem, delitem, insert, append, clear, reverse, extend, pop, remove, iadd等, 这些都是可变序列的特性.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MutableSequence</span>(<span class="title class_ inherited__">Sequence</span>):</span><br><span class="line"></span><br><span class="line">    __slots__ = ()</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;All the operations on a read-write sequence.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Concrete subclasses must provide __new__ or __init__,</span></span><br><span class="line"><span class="string">    __getitem__, __setitem__, __delitem__, __len__, and insert().</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, index, value</span>):</span><br><span class="line">        <span class="keyword">raise</span> IndexError</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self, index</span>):</span><br><span class="line">        <span class="keyword">raise</span> IndexError</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">insert</span>(<span class="params">self, index, value</span>):</span><br><span class="line">        <span class="string">&#x27;S.insert(index, value) -- insert value before index&#x27;</span></span><br><span class="line">        <span class="keyword">raise</span> IndexError</span><br></pre></td></tr></table></figure>

<h2 id="5-3-list中extend方法区别"><a href="#5-3-list中extend方法区别" class="headerlink" title="5.3 list中extend方法区别"></a><strong>5.3 list中extend方法区别</strong></h2><h3 id="序列的-、-x3D-和extend的区别"><a href="#序列的-、-x3D-和extend的区别" class="headerlink" title="序列的+、+&#x3D;和extend的区别"></a><strong>序列的+、+&#x3D;和extend的区别</strong></h3><p>这三个都可以把list进行连接</p>
<ul>
<li>区别一: + 和 +&#x3D;占用空间不一样</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">c=a+b</span><br><span class="line">m = <span class="built_in">id</span>(a)</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment"># c是产生的新的list</span></span><br><span class="line"></span><br><span class="line">a+=b</span><br><span class="line">n = <span class="built_in">id</span>(a)</span><br><span class="line"><span class="built_in">print</span>(m == n) <span class="comment">#True</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># a还是原来那个list</span></span><br><span class="line"><span class="comment">#============================</span></span><br><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">m = <span class="built_in">id</span>(a)</span><br><span class="line"></span><br><span class="line">a = a+b</span><br><span class="line">k = <span class="built_in">id</span>(a)</span><br><span class="line"><span class="built_in">print</span>(k==m) <span class="comment">#False 说明+的结果是存在新的内存位置。+=内存位置不变</span></span><br></pre></td></tr></table></figure>

<ul>
<li>区别二: + 两边的数据类型要一致</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">a+=b</span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment"># a = [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line">c=a+b</span><br><span class="line"></span><br><span class="line"><span class="comment"># TypeError: can only concatenate list (not &quot;tuple&quot;) to list</span></span><br><span class="line"><span class="built_in">print</span>(c)</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;原因是因为+&#x3D;是调用<code>MutableSequence</code>中的<code>__iadd__</code>, 它是调用<code>extend</code>, 接收一个<code>iterable</code>并通过for循环append.&#x3D;&#x3D;</p>
<ul>
<li>entend和append的区别</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=(<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">a.extend((<span class="number">9</span>,<span class="number">10</span>)) <span class="comment"># 利用for循环内的append进行连接</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line">a.append(b) <span class="comment"># 直接连接的是整体不会拆开合并</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">10</span>, (<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)]</span><br></pre></td></tr></table></figure>

<h2 id="5-4-实现可切片的对象"><a href="#5-4-实现可切片的对象" class="headerlink" title="5.4 实现可切片的对象"></a>5.4 <strong>实现可切片的对象</strong></h2><h3 id="切片神操作，你会多少"><a href="#切片神操作，你会多少" class="headerlink" title="切片神操作，你会多少?"></a>切片神操作，你会多少?</h3><p>首先先讲下切片的公式, 模式[start : end : step]</p>
<ol>
<li>start是切片的起始位置, 不填默认为0</li>
<li>end是切片的截至位置, 不填默认为列表的长度</li>
<li>step是切片的跨度, 也就是切片跳跃的长度，官方说法是步长，如果不指定值就是默认是1</li>
</ol>
<h3 id="切片取值"><a href="#切片取值" class="headerlink" title="切片取值"></a>切片取值</h3><ul>
<li>对列表进行切片操作是会返回一个新的列表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">alist=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[::])    <span class="comment"># 打印全部</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[:])     <span class="comment"># 打印全部</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[::-<span class="number">1</span>])  <span class="comment"># 对列表进行反转</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">1</span>::<span class="number">2</span>])  <span class="comment"># 取奇数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[::<span class="number">2</span>])   <span class="comment"># 取偶数</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">1</span>:<span class="number">4</span>])   <span class="comment"># 取列表位置1到4(不包括4的位置)</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">1</span>:<span class="number">100</span>]) <span class="comment"># 如果截至位置大于列表长度取列表的长度。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">100</span>:])  <span class="comment"># 如果起始位置大于列表长度取值为空</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[]</span><br></pre></td></tr></table></figure>

<h3 id="切片赋值"><a href="#切片赋值" class="headerlink" title="切片赋值"></a>切片赋值</h3><p><code>alist[len(alist):]=[10]   # 在尾部增加列表</code><br><code>alist[:0]=[0]             # 在开始位置前增加列表</code><br><code>alist[2:2]=[3.3]          # 在第3位置插入列表</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">alist=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(alist))         <span class="comment"># 打印长度</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">9</span></span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">0</span>])           <span class="comment"># 取第0个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span></span><br><span class="line">alist[<span class="built_in">len</span>(alist):]=[<span class="number">10</span>]   <span class="comment"># 在尾部增加列表</span></span><br><span class="line">alist[:<span class="number">0</span>]=[<span class="number">0</span>]             <span class="comment"># 在开始位置前增加列表</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="built_in">print</span>(alist[<span class="number">2</span>:<span class="number">2</span>])         <span class="comment"># 空值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[]</span><br><span class="line">alist[<span class="number">2</span>:<span class="number">2</span>]=[<span class="number">3.3</span>]          <span class="comment"># 在第3位置插入列表</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">0</span>, <span class="number">1</span>, <span class="number">3.3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">alist[:<span class="number">8</span>]=[<span class="number">12</span>]             <span class="comment"># 前8个元素全变成[12]</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">12</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">alist[<span class="number">2</span>:]=[<span class="number">13</span>]             <span class="comment"># 从第三个位置到结尾变成[13]</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">12</span>, <span class="number">7</span>, <span class="number">13</span>]</span><br><span class="line"></span><br><span class="line">alist=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line">alist[::<span class="number">2</span>]=[<span class="number">0</span>]*<span class="number">5</span>           <span class="comment"># 偶数前5个为修改成0, 左边要修改的数量和右边的数量要相等,如果不等就报错</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">alist=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line">alist[:<span class="number">3</span>]=[]               <span class="comment"># 删除前三个元素</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="keyword">del</span> alist[:<span class="number">3</span>]              <span class="comment"># 用del删除前三个</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">alist=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]</span><br><span class="line"><span class="keyword">del</span> alist[::<span class="number">2</span>]             <span class="comment"># 奇数位置都要删除</span></span><br><span class="line"><span class="built_in">print</span>(alist)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br></pre></td></tr></table></figure>

<h3 id="编写一个不可变的序列类"><a href="#编写一个不可变的序列类" class="headerlink" title="编写一个不可变的序列类"></a>编写一个不可变的序列类</h3><p>之前提到的<code>Sequence</code>就是一个不可变序列的<strong>抽象基类</strong>, 所以我们只要实现了它内部的魔法函数, 就能实现一个不可变的序列类.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> <span class="type">Sequence</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Group</span>(<span class="title class_ inherited__">Sequence</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, group_name, staffs</span>):</span><br><span class="line">        self.group_name = group_name</span><br><span class="line">        self.staffs = staffs</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">len</span>(self.staffs)</span><br><span class="line"></span><br><span class="line">group = Group(group_name=<span class="string">&#x27;user&#x27;</span>, staffs=[<span class="string">&#x27;rib1&#x27;</span>, <span class="string">&#x27;rib2&#x27;</span>, <span class="string">&#x27;rib3&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(group[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p>首先根据源码可知我们必须实现<code>__getitem__</code>和<code>__len__</code>, 我们来好好研究一下<code>__getitem__</code>这个魔法函数. 如果是group[1], 那么item是int(1), 如果group[:2], 那么item是一个<code>slice(None, 2, None)</code>, 所以我们可以通过item进行切片返回.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">    <span class="keyword">return</span> self.staffs[item]</span><br></pre></td></tr></table></figure>

<p>但是如果想返回的还是Group对象:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> Group(group_name=<span class="string">&#x27;user&#x27;</span>,staffs = self.staffs[item])</span><br></pre></td></tr></table></figure>

<p>但是Group直接写死了不好, 因为是通过group调用, 所以self指向group对象, 而且传入的是int的时候我们需要返回[]:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, item</span>):</span><br><span class="line">    cls = <span class="built_in">type</span>(self)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(item, <span class="built_in">slice</span>):</span><br><span class="line">        <span class="keyword">return</span> cls(group_name=<span class="string">&#x27;user&#x27;</span>,staffs = self.staffs[item])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(item, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">return</span> cls(group_name=<span class="string">&#x27;user&#x27;</span>,staffs = [self.staffs[item]])</span><br></pre></td></tr></table></figure>

<p>同理我们如果还需要实现其他功能:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">def</span> <span class="title function_">__reversed__</span>(<span class="params">self</span>):</span><br><span class="line">        self.staffs.reverse()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">iter</span>(self.staffs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">in</span> self.staffs:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">reversed</span>(group)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(<span class="string">&#x27;rib1&#x27;</span> <span class="keyword">in</span> group)</span><br></pre></td></tr></table></figure>

<h2 id="5-5-bisect维护已排序序列"><a href="#5-5-bisect维护已排序序列" class="headerlink" title="5.5 bisect维护已排序序列"></a><strong>5.5 bisect维护已排序序列</strong></h2><h3 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h3><ul>
<li>首先需要有序列的概念, list只是序列的一种</li>
</ul>
<h3 id="bisect用于维护已排序序列"><a href="#bisect用于维护已排序序列" class="headerlink" title="bisect用于维护已排序序列"></a>bisect用于维护已排序序列</h3><ul>
<li>使用bisect插入数据会将数据按顺序排序(升序)</li>
<li>bisect利用二分查找来维护排序序列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> bisect</span><br><span class="line"></span><br><span class="line">inter_list = []</span><br><span class="line">bisect.insort(inter_list, <span class="number">3</span>)</span><br><span class="line">bisect.insort(inter_list, <span class="number">2</span>)</span><br><span class="line">bisect.insort(inter_list, <span class="number">5</span>)</span><br><span class="line">bisect.insort(inter_list, <span class="number">1</span>)</span><br><span class="line">bisect.insort(inter_list, <span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(inter_list)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(bisect.insort_left(inter_list, <span class="number">4</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(inter_list)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(bisect.insort_left(inter_list, <span class="number">3.0</span>))</span><br><span class="line"><span class="built_in">print</span>(inter_list)</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br></pre></td></tr></table></figure>

<p>其中默认插入是右边插入<code>insort = insort_right</code></p>
<ul>
<li>查找将会插入的位置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inter_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3.0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(bisect.bisect(inter_list,<span class="number">2.0</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>其中默认插入是右边插入<code>bisect = bisect_right</code></p>
<h2 id="5-6-什么时候我们不该使用列表"><a href="#5-6-什么时候我们不该使用列表" class="headerlink" title="5.6 什么时候我们不该使用列表"></a><strong>5.6 什么时候我们不该使用列表</strong></h2><h3 id="array"><a href="#array" class="headerlink" title="array"></a>array</h3><p>前面在序列分类的时候提到了一种array类型, 它其实是C语言中的数组, 与list主要有如下区别:</p>
<ul>
<li>array只能存放指定的数据类型</li>
<li>array的数据在内存中是连续的</li>
<li>array的效率和性能会比list更高</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> array</span><br><span class="line"></span><br><span class="line">my_array = array.array(<span class="string">&quot;i&quot;</span>)</span><br><span class="line">my_array.append(<span class="number">1</span>)</span><br><span class="line">my_array.append(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(my_array)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>array(<span class="string">&#x27;i&#x27;</span>, [<span class="number">1</span>, <span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<h2 id="5-7-列表推导式、生成器表达式、字典推导式"><a href="#5-7-列表推导式、生成器表达式、字典推导式" class="headerlink" title="5.7 列表推导式、生成器表达式、字典推导式"></a><strong>5.7 列表推导式、生成器表达式、字典推导式</strong></h2><ul>
<li>简单的for循环都可以用推导式进行完成，性能高比较高，但是如果场景过于复杂就不要用，可读性要排在第一位.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列表生成式的性能高于列表操作</span></span><br><span class="line">list1 = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>) <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>]</span><br><span class="line">list2 = [i * i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>)]</span><br><span class="line"><span class="built_in">print</span>(list1)</span><br><span class="line"><span class="built_in">print</span>(list2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成器表达式</span></span><br><span class="line">gen1 = (i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>) <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(gen1))</span><br><span class="line">list3 = <span class="built_in">list</span>(gen1)</span><br><span class="line"><span class="built_in">print</span>(list3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字典推导式</span></span><br><span class="line">b=&#123;<span class="string">&quot;boby1&quot;</span>:<span class="number">30</span>,<span class="string">&quot;boby2&quot;</span>:<span class="number">60</span>&#125;</span><br><span class="line"><span class="built_in">dict</span>=&#123;value:(key+<span class="number">1</span>) <span class="keyword">for</span> value,key <span class="keyword">in</span> b.items() &#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dict</span>)</span><br></pre></td></tr></table></figure>

<h1 id="6、深入python的set和dict"><a href="#6、深入python的set和dict" class="headerlink" title="6、深入python的set和dict"></a><strong>6、深入python的set和dict</strong></h1><h2 id="6-1-dict的abc继承关系"><a href="#6-1-dict的abc继承关系" class="headerlink" title="6.1 dict的abc继承关系"></a><strong>6.1 dict的abc继承关系</strong></h2><h3 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h3><p>通过抽象基类来理解python中dict的继承关系,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__all__ = [<span class="string">&quot;Awaitable&quot;</span>, <span class="string">&quot;Coroutine&quot;</span>,</span><br><span class="line">           <span class="string">&quot;AsyncIterable&quot;</span>, <span class="string">&quot;AsyncIterator&quot;</span>, <span class="string">&quot;AsyncGenerator&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Hashable&quot;</span>, <span class="string">&quot;Iterable&quot;</span>, <span class="string">&quot;Iterator&quot;</span>, <span class="string">&quot;Generator&quot;</span>, <span class="string">&quot;Reversible&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sized&quot;</span>, <span class="string">&quot;Container&quot;</span>, <span class="string">&quot;Callable&quot;</span>, <span class="string">&quot;Collection&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Set&quot;</span>, <span class="string">&quot;MutableSet&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Mapping&quot;</span>, <span class="string">&quot;MutableMapping&quot;</span>,</span><br><span class="line">           <span class="string">&quot;MappingView&quot;</span>, <span class="string">&quot;KeysView&quot;</span>, <span class="string">&quot;ItemsView&quot;</span>, <span class="string">&quot;ValuesView&quot;</span>,</span><br><span class="line">           <span class="string">&quot;Sequence&quot;</span>, <span class="string">&quot;MutableSequence&quot;</span>,</span><br><span class="line">           <span class="string">&quot;ByteString&quot;</span>,</span><br><span class="line">           ]</span><br></pre></td></tr></table></figure>

<p>dict其实是属于<code>MutableMapping</code>, 它继承<code>Mapping</code>, <code>Mapping</code>继承<code>Collection</code>, 里面包括<code>__len__</code>,<code>__iter__</code>, <code>__contains__</code>, 所以dict和序列有很多接近的地方.</p>
<p>a是一个dict对象, 它并不是继承了<code>MutableMapping</code>, 而是实现了<code>MutableMapping</code>中的方法和魔法函数.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections.abc <span class="keyword">import</span> Mapping, MutableMapping</span><br><span class="line"><span class="comment">#dict属于mapping类型</span></span><br><span class="line"></span><br><span class="line">a = &#123;&#125;</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">isinstance</span>(a, MutableMapping))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<h2 id="6-2-dict的常用方法"><a href="#6-2-dict的常用方法" class="headerlink" title="6.2 dict的常用方法"></a><strong>6.2 dict的常用方法</strong></h2><h3 id="dict的常用操作"><a href="#dict的常用操作" class="headerlink" title="dict的常用操作"></a>dict的常用操作</h3><ul>
<li>clear：clear的功能是对dict的内容进行清除.没有任何的返回值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=&#123;<span class="string">&quot;person1&quot;</span>:&#123;<span class="string">&quot;Andy&quot;</span>:<span class="number">30</span>&#125;,<span class="string">&quot;person12&quot;</span>:&#123;<span class="string">&quot;Lady&quot;</span>:<span class="number">45</span>&#125;&#125;</span><br><span class="line">a.clear()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>浅copy和深copy</li>
<li>fromkeys：首先这是一个静态方法, 可以直接使用类名调用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@staticmethod </span><span class="comment"># known case</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fromkeys</span>(<span class="params">*args, **kwargs</span>): <span class="comment"># real signature unknown</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Returns a new dict with keys from iterable and values equal to value. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="string">&quot;person1&quot;</span>,<span class="string">&quot;person2&quot;</span>]</span><br><span class="line"></span><br><span class="line">b=<span class="built_in">dict</span>.fromkeys(a,<span class="string">&quot;company&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;<span class="string">&#x27;person1&#x27;</span>: <span class="string">&#x27;company&#x27;</span>, <span class="string">&#x27;person2&#x27;</span>: <span class="string">&#x27;company&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>get：解决key没有对应的value报错的问题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(a.get(<span class="string">&quot;person&quot;</span>,&#123;&#125;))</span><br></pre></td></tr></table></figure>

<ul>
<li><p>items, keys, values：取值</p>
</li>
<li><p>pop，popitem：删除并返回</p>
</li>
<li><p>setdefault：如果key存在使用get方法, 如果key不存在使用set方法</p>
</li>
<li><p>update：两个字典合并</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a=&#123;<span class="string">&quot;person1&quot;</span>:&#123;<span class="string">&quot;Andy&quot;</span>:<span class="number">30</span>&#125;,<span class="string">&quot;person12&quot;</span>:&#123;<span class="string">&quot;Lady&quot;</span>:<span class="number">45</span>&#125;&#125;</span><br><span class="line">b=&#123;<span class="string">&quot;person1&quot;</span>:&#123;<span class="string">&quot;Andy&quot;</span>:<span class="number">40</span>&#125;,<span class="string">&quot;person20&quot;</span>:&#123;<span class="string">&quot;Lady&quot;</span>:<span class="number">80</span>&#125;&#125;</span><br><span class="line"><span class="built_in">print</span>(b.update(a)) <span class="comment"># 没有返回值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"><span class="built_in">print</span>(b) <span class="comment"># 如果key重复, 使用a的value</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;<span class="string">&#x27;person1&#x27;</span>: &#123;<span class="string">&#x27;Andy&#x27;</span>: <span class="number">30</span>&#125;, <span class="string">&#x27;person20&#x27;</span>: &#123;<span class="string">&#x27;Lady&#x27;</span>: <span class="number">80</span>&#125;, <span class="string">&#x27;person12&#x27;</span>: &#123;<span class="string">&#x27;Lady&#x27;</span>: <span class="number">45</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-3-dict的子类"><a href="#6-3-dict的子类" class="headerlink" title="6.3 dict的子类"></a><strong>6.3 dict的子类</strong></h2><h3 id="UserDict"><a href="#UserDict" class="headerlink" title="UserDict"></a>UserDict</h3><p>dict是一个类, 我们就可以尝试继承它:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">My_dict</span>(<span class="title class_ inherited__">dict</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="built_in">super</span>().__setitem__(key,value*value)</span><br><span class="line"></span><br><span class="line">a=My_dict(one=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;one&quot;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span></span><br></pre></td></tr></table></figure>

<p>发现值没有变化, 我们去查看dict的源码, 并没有实现<code>__setitem__</code>, 这个方法没有做任何处理，并不适用继承:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, *args, **kwargs</span>): <span class="comment"># real signature unknown</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot; Set self[key] to value. &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>这个时候我们需要继承UserDict, 它是继承于<code>MutableMapping</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> UserDict</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">My_dict</span>(<span class="title class_ inherited__">UserDict</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="built_in">super</span>().__setitem__(key,value*value)</span><br><span class="line"></span><br><span class="line">a=My_dict(one=<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(a[<span class="string">&quot;one&quot;</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">4</span></span><br></pre></td></tr></table></figure>

<p>在UserDict的源码中是实现了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, item</span>): self.data[key] = item</span><br></pre></td></tr></table></figure>

<p>所以如果需要继承dict, 我们应该去继承UserDict. 我们可以理解为<strong>dict是使用c语言去实现</strong>, 而UserDict是使用python语言去实现了一遍dict.</p>
<h3 id="defaultdict"><a href="#defaultdict" class="headerlink" title="defaultdict"></a>defaultdict</h3><p>dict是属于MutableMapping的虚子类，虽然dict实现了MutableMapping定义的所有方法，但是是靠解释器内部实现的。他们两个的关系是通过register函数注册后“绑”到一起的。</p>
<p>因为python内置的dict类实际上没有继承MutableMapping类，C语言编写的内置类型怎么可能继承自python语言编写的抽象基类呢？检查下dict类的MRO方法解析列表，它的“真实”基类们就一清二楚了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dict</span>.__mro__</span><br><span class="line">(&lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;, &lt;<span class="keyword">class</span> <span class="string">&#x27;object&#x27;</span>&gt;)</span><br></pre></td></tr></table></figure>

<p>那么为何通过函数检查dict，python又会告诉你“dict是MutableMapping的子类”呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> collections</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">issubclass</span>(<span class="built_in">dict</span>, collections.abc.MutableMapping)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>

<p>因为python的抽象基类能够【<strong>注册虚拟子类</strong>】：在你import collections包时，该包的代码就已经执行了MutableMapping.register()方法，将dict注册为了自己的虚拟子类，从而可以通过函数检查。</p>
<p>defaultdict是dict的一个子类,</p>
<p>我们来看一下<code>UserDict</code>中的<code>__getitem__</code>的:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> self.data:</span><br><span class="line">        <span class="keyword">return</span> self.data[key]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(self.__class__, <span class="string">&quot;__missing__&quot;</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__class__.__missing__(self, key)</span><br><span class="line">    <span class="keyword">raise</span> KeyError(key)</span><br></pre></td></tr></table></figure>

<p>如果key不存在就查看有没有<code>__missing__</code>, 如果有就调用该方法, 而在<code>defaultdict</code>中重载了该方法.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__missing__</span>(<span class="params">self, key</span>): <span class="comment"># real signature unknown; restored from __doc__</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    __missing__(key) # Called by __getitem__ for missing key; pseudo-code:</span></span><br><span class="line"><span class="string">        if self.default_factory is None: raise KeyError((key,))</span></span><br><span class="line"><span class="string">        self[key] = value = self.default_factory()</span></span><br><span class="line"><span class="string">        return value</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>使用:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line">my_dict = defaultdict(<span class="built_in">dict</span>)</span><br><span class="line">my_value = my_dict[<span class="string">&quot;bobby&quot;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>defaultdict(&lt;<span class="keyword">class</span> <span class="string">&#x27;dict&#x27;</span>&gt;, &#123;<span class="string">&#x27;bobby&#x27;</span>: &#123;&#125;&#125;)</span><br><span class="line"></span><br><span class="line">fruit=[<span class="string">&quot;apple&quot;</span>,<span class="string">&quot;banana&quot;</span>,<span class="string">&quot;orange&quot;</span>]</span><br><span class="line">v=defaultdict(<span class="built_in">int</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> fruit:</span><br><span class="line">    v[i]+=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(v)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>defaultdict(&lt;<span class="keyword">class</span> <span class="string">&#x27;int&#x27;</span>&gt;, &#123;<span class="string">&#x27;default_factory&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;apple&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;banana&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;orange&#x27;</span>: <span class="number">1</span>&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="6-4-set和frozenset"><a href="#6-4-set和frozenset" class="headerlink" title="6.4 set和frozenset"></a><strong>6.4 set和frozenset</strong></h2><h3 id="set-和-frozenset的应用场景及区别"><a href="#set-和-frozenset的应用场景及区别" class="headerlink" title="set 和 frozenset的应用场景及区别"></a>set 和 frozenset的应用场景及区别</h3><ul>
<li>set是集合，frozenset是不可变集合。</li>
<li>set最大的特性是不重合，在去重的时候用的最多。</li>
<li>set是无序的</li>
<li>set的性能比较高, 因为他用到了哈希编码</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seq=(<span class="params"></span>)</span>): <span class="comment"># known special case of set.__init__</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    set() -&gt; new empty set object</span></span><br><span class="line"><span class="string">    set(iterable) -&gt; new set object</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    Build an unordered collection of unique elements.</span></span><br><span class="line"><span class="string">    # (copied from class doc)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>set初始化是接收一个可迭代对象, 比如str, list, dict, tuple…</p>
<p>set的另一种初始化方式是{‘a’,’b’,’c’}</p>
<h3 id="frozenset"><a href="#frozenset" class="headerlink" title="frozenset"></a>frozenset</h3><p>不可变集合是无法修改的, 可以作为dict的key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=&#123;<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>&#125;</span><br><span class="line">a.add(<span class="string">&quot;d&quot;</span>) <span class="comment"># 正常</span></span><br><span class="line"></span><br><span class="line">a=<span class="built_in">frozenset</span>(<span class="string">&quot;abcd&quot;</span>)</span><br><span class="line">a.add(<span class="string">&quot;d&quot;</span>) <span class="comment"># 报错</span></span><br></pre></td></tr></table></figure>

<h3 id="常用方法"><a href="#常用方法" class="headerlink" title="常用方法"></a>常用方法</h3><ul>
<li>update 方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="built_in">set</span>(<span class="string">&quot;abc&quot;</span>)</span><br><span class="line">a.update(<span class="string">&quot;bcd&quot;</span>) <span class="comment"># 取的是总集</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;c&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>集合运算(|，&amp;，-)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="built_in">set</span>(<span class="string">&quot;abc&quot;</span>)</span><br><span class="line">b=<span class="built_in">set</span>(<span class="string">&quot;bcd&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(a - b) <span class="comment"># 对a进行去重</span></span><br><span class="line"><span class="built_in">print</span>(a | b) <span class="comment"># 并集</span></span><br><span class="line"><span class="built_in">print</span>(a &amp; b) <span class="comment"># 交集</span></span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&#x27;a&#x27;</span>&#125;</span><br><span class="line">&#123;<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;a&#x27;</span>&#125;</span><br><span class="line">&#123;<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;b&#x27;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>原理是调用了相应的魔法函数</p>
<h2 id="6-5-dict和set的实现原理"><a href="#6-5-dict和set的实现原理" class="headerlink" title="6.5 dict和set的实现原理"></a><strong>6.5 dict和set的实现原理</strong></h2><h3 id="效率"><a href="#效率" class="headerlink" title="效率"></a>效率</h3><ul>
<li><p>dict查找的性能远远大于list</p>
</li>
<li><p>在list中查找元素时间会随着list的增大而增大</p>
</li>
<li><p>在dict中查找元素时间不会随着dict的增大而增大</p>
</li>
<li><p><strong>哈希表</strong></p>
</li>
<li><p>哈希表查找</p>
</li>
</ul>
<p><img src="image-20210519143812860.png" alt="image-20210519143812860"></p>
<ol>
<li>dict的key或者set的值都必须是可以hash的</li>
<li><strong>不可变对象都是可hash的</strong>, str,fronzenset,tuple</li>
<li>自己实现的类使用魔法函数<code>__hash__</code>实现哈希</li>
<li>dict的内存花销大，但是查询速度快，自定义的对象或者python内部的对象都是用dict包装的</li>
<li>dict的存储顺序和元素添加顺序有关</li>
<li>添加数据有可能改变已有数据的顺序, 最开始会申请内存, 然后随着数据的不断添加, 当剩余空间小于三分之一的时候会申请新的内存然后进行数据迁移, 这个时候存储顺序可能会发生改变.</li>
</ol>
<h1 id="7、对象引用、可变性和垃圾回收"><a href="#7、对象引用、可变性和垃圾回收" class="headerlink" title="7、对象引用、可变性和垃圾回收"></a><strong>7、对象引用、可变性和垃圾回收</strong></h1><h2 id="7-1-python中的变量"><a href="#7-1-python中的变量" class="headerlink" title="7.1 python中的变量"></a>7.1 python中的变量</h2><ul>
<li>python是动态语言, 变量是没有类型的</li>
<li>java中声明变量是需要指定类型, 然后虚拟机根据类型申请空间, 但是python的变量实质是指针(首先生成对象然后指针指向对象)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不可变类型</span></span><br><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b)) <span class="comment"># 相等</span></span><br><span class="line">首先实例化一个<span class="built_in">int</span>对象<span class="number">1</span>, 然后将变量a指向这个对象, 然后将变量b指向对象<span class="number">1</span>,a和b指向的是同一个对象</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变类型</span></span><br><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b)) <span class="comment"># 不相等</span></span><br><span class="line">首先实例化一个<span class="built_in">list</span>对象, 然后将a指向该对象, 然后再实例化一个<span class="built_in">list</span>对象将b指向该对象, a和b指向的是不同的对象</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可变类型</span></span><br><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">b=a</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">id</span>(b)) <span class="comment"># 相等</span></span><br><span class="line">首先实例化一个<span class="built_in">list</span>对象, 然后将a指向该对象, 然后将a赋值给b, a和b指向的是相同的对象</span><br></pre></td></tr></table></figure>

<h2 id="7-2-x3D-x3D-和is的区别"><a href="#7-2-x3D-x3D-和is的区别" class="headerlink" title="7.2 &#x3D;&#x3D;和is的区别"></a><strong>7.2 &#x3D;&#x3D;和is的区别</strong></h2><ul>
<li>is也被叫做同一性运算符，这个运算符比较判断的是对象间的唯一身份标识，也就是<strong>id是否相同</strong></li>
<li>&#x3D;&#x3D;是利用魔法函数<code>__eq__</code>, 用来比较判断两个对象的**value(值)**是否相等</li>
</ul>
<h2 id="7-3-del语句和垃圾回收"><a href="#7-3-del语句和垃圾回收" class="headerlink" title="7.3 del语句和垃圾回收"></a><strong>7.3 del语句和垃圾回收</strong></h2><h3 id="Python的垃圾回收机制"><a href="#Python的垃圾回收机制" class="headerlink" title="Python的垃圾回收机制"></a>Python的垃圾回收机制</h3><ul>
<li>垃圾回收机制算法采用的是<strong>引用计数</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]  <span class="comment"># 声明变量后，引用计数 +1</span></span><br><span class="line">b=a        <span class="comment"># 增加一个引用，引用计数 +1</span></span><br><span class="line">c=b        <span class="comment"># 增加一个引用，引用计数 +1</span></span><br><span class="line"><span class="keyword">del</span> a      <span class="comment"># 删除a这个指针，引用计数 -1</span></span><br></pre></td></tr></table></figure>

<p>当计数器保存的值为0的时候，也就是意味着没有任何指针指向这块存储。解释器开始清除这块没有任何指针的存储。</p>
<h3 id="垃圾回收魔法函数"><a href="#垃圾回收魔法函数" class="headerlink" title="垃圾回收魔法函数"></a>垃圾回收魔法函数</h3><p><code>__del__</code>可以添加该对象被垃圾回收时的逻辑.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__del__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开始回收了&quot;</span>)</span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line">b=a</span><br><span class="line">c=b</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> a</span><br><span class="line"><span class="keyword">del</span> b</span><br><span class="line"><span class="keyword">del</span> c</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>开始执行`<span class="keyword">del</span> c`时打印`开始回收了`</span><br></pre></td></tr></table></figure>

<h2 id="7-4-一个经典的参数错误"><a href="#7-4-一个经典的参数错误" class="headerlink" title="7.4 一个经典的参数错误."></a><strong>7.4 一个经典的参数错误.</strong></h2><h3 id="经典参数传递错误"><a href="#经典参数传递错误" class="headerlink" title="经典参数传递错误"></a>经典参数传递错误</h3><p><strong>传入int值</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>):</span><br><span class="line">    a+=b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">a=<span class="number">1</span></span><br><span class="line">b=<span class="number">2</span></span><br><span class="line">c=add(a,b)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b,c)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<p><strong>传入list</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>):</span><br><span class="line">    a+=b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">a=[<span class="number">1</span>]</span><br><span class="line">b=[<span class="number">2</span>]</span><br><span class="line">c=add(a,b)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b,c)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>] [<span class="number">2</span>] [<span class="number">1</span>, <span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p><strong>内部使用的是+&#x3D;, 所以内存地址不变</strong>, 所以在执行<code>a+=b</code>的前后a指向的是同一个地址, 只不过地址里面的内容发生改变.</p>
<p><strong>传入元组</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a,b</span>):</span><br><span class="line">    a+=b</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">a=(<span class="number">1</span>)</span><br><span class="line">b=(<span class="number">2</span>)</span><br><span class="line">c=add(a,b)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a,b,c)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>在<strong>传入参数为列表等可变序列</strong>时要注意传入参数有可能在函数内部被改变.</p>
<h1 id="8、元类编程"><a href="#8、元类编程" class="headerlink" title="8、元类编程"></a>8、元类编程</h1><h2 id="8-1-property动态属性"><a href="#8-1-property动态属性" class="headerlink" title="8.1 property动态属性"></a><strong>8.1 property动态属性</strong></h2><h3 id="模块的导入"><a href="#模块的导入" class="headerlink" title="模块的导入"></a>模块的导入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, datetime </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, birthday</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.birthday = birthday </span><br><span class="line"></span><br><span class="line">user = User(<span class="string">&quot;bobby&quot;</span>, date(year=<span class="number">1987</span>, month=<span class="number">1</span>, day=<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&quot;in &#123;&#125; file&quot;</span> . <span class="built_in">format</span>(__file__))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在另一个py文件中导入User类, 连同print也一起被执行了</span></span><br><span class="line"><span class="keyword">from</span> chapter08.text <span class="keyword">import</span> User</span><br></pre></td></tr></table></figure>

<h3 id="property装饰器-属性方法"><a href="#property装饰器-属性方法" class="headerlink" title="property装饰器(属性方法)"></a>property装饰器(属性方法)</h3><p>现在假如一个类有年龄属性, 我们需要设置值并能获取值</p>
<ul>
<li>方法一: 在<code>__init__()</code>中设置age, 但是问题是对于赋值无法添加处理或者校验</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name,age</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        self.age=age</span><br><span class="line">stu = Student(<span class="string">&#x27;Tom&#x27;</span>, <span class="number">12</span>)</span><br><span class="line">stu.age = <span class="number">20</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方法二: 使用set_age和get_age</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_age</span>(<span class="params">self, age</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(age, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span> &lt; age &lt; <span class="number">120</span>:</span><br><span class="line">                self.age = age</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;请输入合法的年龄&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu = Student(<span class="string">&quot;Lady&quot;</span>)</span><br><span class="line">stu.set_age(<span class="number">119</span>)  <span class="comment"># stu自己给自己添加了一个age 属性，所以不会报错。这个属性只是属于stu对象</span></span><br><span class="line"><span class="built_in">print</span>(stu.age)</span><br></pre></td></tr></table></figure>

<p>为了让age更安全, 可以改成_age</p>
<ul>
<li>property就是实现了上面的set_age和get_age的作用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self._age = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"><span class="meta">    @age.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self,age</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(age,<span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="number">0</span>&lt;age&lt;<span class="number">120</span>:</span><br><span class="line">                self._age=age</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;请输入合法的年龄&quot;</span>)</span><br><span class="line"></span><br><span class="line">stu=Student(<span class="string">&quot;Lady&quot;</span>)</span><br><span class="line">stu.age=<span class="number">119</span></span><br><span class="line"><span class="built_in">print</span>(stu.age)</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> get和<span class="built_in">set</span>的方法名称都要一样（age）</span><br><span class="line"><span class="number">2.</span> <span class="built_in">set</span>方法返回的属性前面加个<span class="string">&quot;_&quot;</span></span><br><span class="line"><span class="number">3.</span> @<span class="built_in">property</span>是针对get方法</span><br><span class="line"><span class="number">4.</span> @age.setter是针对<span class="built_in">set</span>方法，是@<span class="built_in">property</span>本身又创建了另一个装饰器</span><br><span class="line"><span class="number">5.</span> 直接可以这样stu.age=<span class="number">10</span>对象名.方法名进行赋值，</span><br><span class="line"><span class="number">6.</span> 只定义getter方法，不定义setter方法是一个只读属性</span><br></pre></td></tr></table></figure>

<h3 id="最大特点"><a href="#最大特点" class="headerlink" title="最大特点"></a>最大特点</h3><p><strong>属性值可动态获取</strong></p>
<h2 id="8-2-getattr-、-getattribute-魔法函数"><a href="#8-2-getattr-、-getattribute-魔法函数" class="headerlink" title="8.2 __getattr__、__getattribute__魔法函数"></a><strong>8.2 <code>__getattr__、__getattribute__</code>魔法函数</strong></h2><h3 id="getattr-和-getattribute-的区别"><a href="#getattr-和-getattribute-的区别" class="headerlink" title="__getattr__和__getattribute__的区别"></a><code>__getattr__</code>和<code>__getattribute__</code>的区别</h3><p>优先进入<code>__getattribute__</code>(如果两个都实现了的话)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,info=&#123;&#125;</span>):</span><br><span class="line">        self.info = info</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="comment"># return self.info[item]</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;getattr&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattribute__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;getattributer&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    user = User(info=&#123;<span class="string">&quot;company_name&quot;</span>:<span class="string">&quot;imooc&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;bobby&quot;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(user.test) </span><br><span class="line">    </span><br><span class="line"><span class="comment">#getattributer </span></span><br><span class="line"><span class="comment">#None</span></span><br></pre></td></tr></table></figure>

<p><code>__getattr__</code>： 当实例化对象调用<strong>属性不存在的时候调用</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line"><span class="built_in">print</span>(a.age)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>AttributeError: <span class="string">&#x27;A&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;age&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, item</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;即使你没有属性也不会报错&quot;</span>)</span><br><span class="line"></span><br><span class="line">a=A()</span><br><span class="line"><span class="built_in">print</span>(a.age)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>即使你没有属性也不会报错</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br></pre></td></tr></table></figure>

<p>作用: 我们可以指定在找不到该属性的时候实现的操作, 比如修改查找的名称, 重新指定查找的区域等</p>
<h3 id="getattribute"><a href="#getattribute" class="headerlink" title="__getattribute__"></a><code>__getattribute__</code></h3><p><strong>执行查找, 无条件进入该魔法函数, 即使所查找的属性不存在</strong></p>
<h2 id="8-3-属性描述符和属性查找过程"><a href="#8-3-属性描述符和属性查找过程" class="headerlink" title="8.3 属性描述符和属性查找过程."></a><strong>8.3 属性描述符和属性查找过程.</strong></h2><h3 id="属性描述符-1"><a href="#属性描述符-1" class="headerlink" title="属性描述符"></a>属性描述符</h3><p>前面提到的age在输入的时候需要校验, 实现是通过property的setter, 但是如果很多输入字段那么就要写很多重复的代码.这里就要用到属性描述符。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个对象只要实现__get__、__set__或者__delete__就是一个属性描述符对象</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IntField</span>:</span><br><span class="line">    <span class="comment"># 数据描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">return</span> self.value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, numbers.Integral):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;int value need&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;positive value need&quot;</span>)</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NonDataIntField</span>:</span><br><span class="line">    <span class="comment"># 非数据属性描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">return</span> self.value</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    age = IntField() <span class="comment"># age本来是个对象，放在类里当作了User类属性</span></span><br><span class="line"></span><br><span class="line">user = User()</span><br><span class="line">user.age = <span class="number">12</span> <span class="comment"># 会进入IntField的__set__</span></span><br><span class="line"></span><br><span class="line">instance</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;__main__.User <span class="built_in">object</span> at <span class="number">0x00000259359F9128</span>&gt;</span><br><span class="line">self</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;__main__.IntField <span class="built_in">object</span> at <span class="number">0x00000259359F9E48</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="user-age的查找顺序"><a href="#user-age的查找顺序" class="headerlink" title="user.age的查找顺序"></a>user.age的查找顺序</h3><ul>
<li>如果user是某个类的实例，那么<code>user.age</code>（以及等价的<code>getattr(user,’age’)</code>）</li>
<li>首先调用<code>__getattribute__</code>, 如果在<code>__getattribute__</code>找不到属性就会抛出<code>AttributeError</code></li>
<li>如果类定义了<code>__getattr__</code>方法，在抛出<code>AttributeError</code>的时候就会调用到<code>__getattr__</code></li>
<li>而对于描述符<code>__get__</code>的调用，则是发生在<code>__getattribute__</code>内部的。</li>
</ul>
<p>user &#x3D; User(), 那么user.age 顺序如下：</p>
<ol>
<li>如果“age”是出现在User或其基类的<code>__dict__</code>中，且age是data descriptor，那么调用其<code>__get__</code>方法</li>
<li>如果“age”出现在user(对象)的<code>__dict__</code>中， 那么直接返回 <code>obj.__dict__[‘age’]</code></li>
<li>如果“age”出现在User(类)或其基类的<code>__dict__</code>中</li>
</ol>
<ul>
<li><p>如果age是non-data descriptor，那么调用其<code>__get__</code>方法</p>
</li>
<li><p>如果不是，返回<code>__dict__[‘age’]</code></p>
<p>4.如果User有<code>__getattr__</code>方法，调用<code>__getattr__</code>方法，否则</p>
</li>
</ul>
<p>​       5.抛出AttributeError</p>
<ul>
<li>类的静态函数、类函数、普通函数、全局变量以及一些内置的属性都是放在类.__dict__里的</li>
<li>对象.__dict__中存储了一些self.xxx的一些东西</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numbers</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IntField</span>:</span><br><span class="line">    <span class="comment">#数据描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">return</span> self.value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, numbers.Integral):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;int value need&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;positive value need&quot;</span>)</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delete__</span>(<span class="params">self, instance</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    age = IntField()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    user = User()</span><br><span class="line">    <span class="comment"># user.age = 30           # 进入数据描述符的__set__</span></span><br><span class="line">    <span class="comment"># getattr(user, &#x27;age&#x27;,18) # 进入数据描述符的__get__</span></span><br><span class="line">    <span class="comment"># print(user.age)         # 进入数据描述符的__get__</span></span><br><span class="line">    user.__dict__[<span class="string">&quot;age&quot;</span>] = <span class="number">18</span></span><br><span class="line">    <span class="built_in">print</span>(user.__dict__[<span class="string">&quot;age&quot;</span>])</span><br><span class="line"></span><br><span class="line">    user.__dict__[<span class="string">&quot;age&quot;</span>] = <span class="number">18</span></span><br><span class="line">    <span class="built_in">print</span>(user.age)</span><br><span class="line">    &gt;&gt;&gt; <span class="string">&#x27;IntField&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;value&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    age = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    user = User()</span><br><span class="line">    user.name = <span class="number">30</span>         <span class="comment"># 保存在user对象的内存中</span></span><br><span class="line">    <span class="built_in">print</span>(user.name)       <span class="comment"># 从user对象的内存中去取</span></span><br><span class="line">    user.age = <span class="number">30</span>          <span class="comment"># 保存在user对象的内存中, 不影响类的内存中的值</span></span><br><span class="line">    <span class="built_in">print</span>(user.age)       <span class="comment"># 进入数据描述符的__get__</span></span><br><span class="line">    user.__dict__[<span class="string">&quot;age&quot;</span>] = <span class="number">18</span></span><br><span class="line">    <span class="built_in">print</span>(user.__dict__[<span class="string">&quot;age&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span> (user.__dict__)</span><br></pre></td></tr></table></figure>

<h2 id="8-4-new-和-init-的区别"><a href="#8-4-new-和-init-的区别" class="headerlink" title="8.4 __new__和__init__的区别"></a><strong>8.4 <code>__new__和__init__</code>的区别</strong></h2><h3 id="new-和-init-魔法函数区别"><a href="#new-和-init-魔法函数区别" class="headerlink" title="__new__和__init__魔法函数区别"></a><code>__new__和__init__</code>魔法函数区别</h3><ul>
<li>__new__的功能是在生成对象之前所做的动作, 接受的参数是cls 类</li>
<li>__init__是在对象生成之后完善对象的属性, 它接受的是self 对象</li>
<li>对象生成是在new里面return(返回一个对象)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span>  <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;new&quot;</span>)</span><br><span class="line">        <span class="comment"># return super().__new__(cls) 创建并返回一个类对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,name</span>):</span><br><span class="line">        self.name=name</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;init&quot;</span>)</span><br><span class="line"></span><br><span class="line">user=User()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>new</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(user))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;<span class="keyword">class</span> <span class="string">&#x27;NoneType&#x27;</span>&gt;</span><br><span class="line">cls</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;<span class="keyword">class</span> <span class="string">&#x27;__main__.User&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>在执行user &#x3D; User()时, 首先调用User类中的__new__, 其中cls就是User类, 然后继承父类object的中__new__将创建并返回一个类对象, 然后再执行__init__完善对象属性.</p>
<h2 id="8-5-自定义元类"><a href="#8-5-自定义元类" class="headerlink" title="8.5 自定义元类"></a><strong>8.5 自定义元类</strong></h2><h3 id="创建类的方法"><a href="#创建类的方法" class="headerlink" title="创建类的方法"></a>创建类的方法</h3><p><strong>Type动态创建类</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Company=<span class="built_in">type</span>（“类名称”，（继承的基类），&#123;类的属性 &#125;）</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Baseclass</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">say</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;basecalss say&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要有self</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;i am running&quot;</span></span><br><span class="line"></span><br><span class="line">Company=<span class="built_in">type</span>(<span class="string">&quot;Company&quot;</span>,(Baseclass, ),&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;ebaotech&quot;</span>,<span class="string">&quot;Adress&quot;</span>:<span class="string">&quot;杨浦区&quot;</span>,<span class="string">&quot;run&quot;</span>:run&#125;)</span><br><span class="line">co=Company()</span><br><span class="line"><span class="built_in">print</span>(co.name, co.Adress, co.run())</span><br><span class="line">co.say()</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ebaotech 杨浦区 i am running</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>basecalss say</span><br></pre></td></tr></table></figure>

<p><strong>元类就是创建类的类, 刚才的type就是一个元类</strong></p>
<h3 id="自定义元类"><a href="#自定义元类" class="headerlink" title="自定义元类"></a>自定义元类</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 控制User类实例化的过程</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Metaclass</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, *args, **kwargs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(metaclass=Metaclass):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>(<span class="title class_ inherited__">Bar</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>创建Foo会先寻找Foo中有<code>__metaclass__</code>这个属性吗？如果是，Python会在内存中通过<code>__metaclass__</code>创建一个名字为Foo的类对象。如果Python没有找到<code>__metaclass__</code>，它会继续在Bar（父类）中寻找<code>__metaclass__</code>属性，并尝试做和前面同样的操作。如果Python在任何父类中都找不到<code>__metaclass__</code>，它就会在模块层次中去寻找<code>__metaclass__</code>，并尝试做同样的操作。如果还是找不到<code>__metaclass__</code>,Python就会用内置的type来创建这个类对象。</p>
<ul>
<li>之前写抽象接口就使用了metaclass&#x3D;ABCMeta, 其实在ABCMeta里面就是重写了__new__方法. 然后再__new__里面检查被标记为@abstractmethod的方法有没有重载.</li>
</ul>
<h2 id="8-6-通过元类实现orm"><a href="#8-6-通过元类实现orm" class="headerlink" title="8.6 通过元类实现orm"></a><strong>8.6 通过元类实现orm</strong></h2><ul>
<li>创建类的时候对min_value, max_value等进行检查, 在<code>__init__</code>中</li>
<li>对类赋值的时候对min_value, max_value等进行检查, 在<code>__get__</code>中</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numbers</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Field</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IntField</span>(<span class="title class_ inherited__">Field</span>):</span><br><span class="line">    <span class="comment"># 数据描述符</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, db_column, min_value=<span class="literal">None</span>, max_value=<span class="literal">None</span></span>):</span><br><span class="line">        self._value = <span class="literal">None</span></span><br><span class="line">        self.min_value = min_value</span><br><span class="line">        self.max_value = max_value</span><br><span class="line">        self.db_column = db_column</span><br><span class="line">        <span class="keyword">if</span> min_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(min_value, numbers.Integral):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;min_value must be int&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> min_value &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;min_value must be positive int&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> max_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(max_value, numbers.Integral):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;max_value must be int&quot;</span>)</span><br><span class="line">            <span class="keyword">elif</span> max_value &lt; <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;max_value must be positive int&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> min_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> max_value <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> min_value &gt; max_value:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;min_value must be smaller than max_value&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">return</span> self._value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, numbers.Integral):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;int value need&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; self.min_value <span class="keyword">or</span> value &gt; self.max_value:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;value must between min_value and max_value&quot;</span>)</span><br><span class="line">        self._value = value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CharField</span>(<span class="title class_ inherited__">Field</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, db_column, max_length=<span class="literal">None</span></span>):</span><br><span class="line">        self._value = <span class="literal">None</span></span><br><span class="line">        self.db_column = db_column</span><br><span class="line">        <span class="keyword">if</span> max_length <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;you must spcify max_lenth for charfiled&quot;</span>)</span><br><span class="line">        self.max_length = max_length</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__get__</span>(<span class="params">self, instance, owner</span>):</span><br><span class="line">        <span class="keyword">return</span> self._value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__set__</span>(<span class="params">self, instance, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;string value need&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(value) &gt; self.max_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;value len excess len of max_length&quot;</span>)</span><br><span class="line">        self._value = value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ModelMetaClass</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, name, bases, attrs, **kwargs</span>):</span><br><span class="line">        <span class="comment"># BaseModel类的创建也是通过该元类, 但是不需要执行下面的内容</span></span><br><span class="line">        <span class="keyword">if</span> name == <span class="string">&quot;BaseModel&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, name, bases, attrs, **kwargs)</span><br><span class="line">        <span class="comment"># 在attrs中有传入的参数, Meta等, 需要进行处理</span></span><br><span class="line">        fields = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> attrs.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, Field):</span><br><span class="line">                fields[key] = value</span><br><span class="line">        attrs_meta = attrs.get(<span class="string">&quot;Meta&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">        _meta = &#123;&#125;</span><br><span class="line">        db_table = name.lower()</span><br><span class="line">        <span class="keyword">if</span> attrs_meta <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            table = <span class="built_in">getattr</span>(attrs_meta, <span class="string">&quot;db_table&quot;</span>, <span class="literal">None</span>)</span><br><span class="line">            <span class="keyword">if</span> table <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                db_table = table</span><br><span class="line">        _meta[<span class="string">&quot;db_table&quot;</span>] = db_table</span><br><span class="line">        attrs[<span class="string">&quot;_meta&quot;</span>] = _meta</span><br><span class="line">        attrs[<span class="string">&quot;fields&quot;</span>] = fields</span><br><span class="line">        <span class="keyword">del</span> attrs[<span class="string">&quot;Meta&quot;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, name, bases, attrs, **kwargs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseModel</span>(metaclass=ModelMetaClass):</span><br><span class="line">    <span class="comment"># 在__new__中只是对参数进行处理, 并返回cls, 并没有赋给user对象</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> kwargs.items():</span><br><span class="line">            <span class="built_in">setattr</span>(self, key, value)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().__init__()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成sql语句保存到数据库中</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">save</span>(<span class="params">self</span>):</span><br><span class="line">        fields = []</span><br><span class="line">        values = []</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> self.fields.items():</span><br><span class="line">            db_column = value.db_column</span><br><span class="line">            <span class="keyword">if</span> db_column <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                db_column = key.lower()</span><br><span class="line">            fields.append(db_column)</span><br><span class="line">            value = <span class="built_in">getattr</span>(self, key)</span><br><span class="line">            values.append(<span class="built_in">str</span>(value))</span><br><span class="line"></span><br><span class="line">        sql = <span class="string">&quot;insert &#123;db_table&#125;(&#123;fields&#125;) value(&#123;values&#125;)&quot;</span>.<span class="built_in">format</span>(db_table=self._meta[<span class="string">&quot;db_table&quot;</span>],</span><br><span class="line">                                                                   fields=<span class="string">&quot;,&quot;</span>.join(fields), values=<span class="string">&quot;,&quot;</span>.join(values))</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">BaseModel</span>):</span><br><span class="line">    name = CharField(db_column=<span class="string">&quot;name&quot;</span>, max_length=<span class="number">10</span>)</span><br><span class="line">    age = IntField(db_column=<span class="string">&quot;age&quot;</span>, min_value=<span class="number">1</span>, max_value=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Meta</span>:</span><br><span class="line">        db_table = <span class="string">&quot;user&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># user = User(name=&quot;bobby&quot;, age=28)</span></span><br><span class="line">    user = User()</span><br><span class="line">    user.name = <span class="string">&quot;bobby&quot;</span></span><br><span class="line">    user.age = <span class="number">28</span></span><br><span class="line">    user.save()</span><br></pre></td></tr></table></figure>

<h1 id="9、迭代器和生成器"><a href="#9、迭代器和生成器" class="headerlink" title="9、迭代器和生成器"></a>9、<strong>迭代器和生成器</strong></h1>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"># 编程</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2023/06/12/2023-6-read/" rel="next" title="《兴盛与危机——论中国社会超稳定结构》">
                <i class="fa fa-chevron-left"></i> 《兴盛与危机——论中国社会超稳定结构》
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">基础语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="nav-number">1.1.</span> <span class="nav-text">语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#python-%E6%A8%A1%E5%9D%97%E8%BD%BD%E5%85%A5"><span class="nav-number">1.1.1.</span> <span class="nav-text">python 模块载入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E4%B9%8B%E5%89%8D%E7%94%9F%E6%88%90%E7%9A%84%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="nav-number">1.1.2.</span> <span class="nav-text">删除之前生成的文件：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8D%95%E6%8D%89%E6%89%80%E6%9C%89%E5%BC%82%E5%B8%B8"><span class="nav-number">1.1.3.</span> <span class="nav-text">捕捉所有异常</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#try-x2F-except-else"><span class="nav-number">1.1.4.</span> <span class="nav-text">try&#x2F;except else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#finally"><span class="nav-number">1.1.5.</span> <span class="nav-text">finally</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#with-%E6%96%B9%E6%B3%95"><span class="nav-number">1.1.6.</span> <span class="nav-text">with 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%8C%E5%88%97%E8%A1%A8%EF%BC%8C%E5%85%83%E7%BB%84%E5%8F%AF%E4%BB%A5%E5%88%87%E7%89%87"><span class="nav-number">1.1.7.</span> <span class="nav-text">字符串，列表，元组可以切片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#print-%E2%80%98-%E2%80%98-end-x3D-%E2%80%98%E2%80%99-%E4%B8%8D%E6%8D%A2%E8%A1%8C"><span class="nav-number">1.1.8.</span> <span class="nav-text">print(‘* ‘, end &#x3D; ‘’) #不换行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84else-%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.1.9.</span> <span class="nav-text">循环中的else 语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">1.1.10.</span> <span class="nav-text">运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.1.11.</span> <span class="nav-text">可迭代类型</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#int-%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95"><span class="nav-number">1.2.</span> <span class="nav-text">int 常用语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">1.2.1.</span> <span class="nav-text">1 常用数据类型转换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#str-%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95"><span class="nav-number">1.3.</span> <span class="nav-text">str 常用语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%8F%96%E4%B8%8B%E6%A0%87%E5%92%8C%E5%88%87%E7%89%87"><span class="nav-number">1.3.1.</span> <span class="nav-text">1 取下标和切片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-find-amp-amp-rfind"><span class="nav-number">1.3.2.</span> <span class="nav-text">2 find &amp;&amp; rfind</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-index-amp-amp-rindex"><span class="nav-number">1.3.3.</span> <span class="nav-text">3 index &amp;&amp; rindex</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-isalpha-amp-amp-isdigit-amp-amp-isalnum-amp-amp-isspace"><span class="nav-number">1.3.4.</span> <span class="nav-text">4 **isalpha **&amp;&amp; isdigit &amp;&amp; isalnum &amp;&amp; isspace</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-join%EF%BC%9A%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.3.5.</span> <span class="nav-text">5 join：连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-replace"><span class="nav-number">1.3.6.</span> <span class="nav-text">6 replace</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-strip-amp-amp-lstrip-amp-amp-rstrip"><span class="nav-number">1.3.7.</span> <span class="nav-text">7 strip &amp;&amp; lstrip &amp;&amp; rstrip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-title-amp-amp-capitalize"><span class="nav-number">1.3.8.</span> <span class="nav-text">8 title  &amp;&amp; capitalize</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-count"><span class="nav-number">1.3.9.</span> <span class="nav-text">9 count</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-split"><span class="nav-number">1.3.10.</span> <span class="nav-text">10 split</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-startswith-amp-amp-endswith"><span class="nav-number">1.3.11.</span> <span class="nav-text">11 **startswith ** &amp;&amp; endswith</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#12-lower-amp-amp-upper"><span class="nav-number">1.3.12.</span> <span class="nav-text">12 **lower **&amp;&amp; upper</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-ljust-amp-amp-rjust-amp-amp-center"><span class="nav-number">1.3.13.</span> <span class="nav-text">13 ljust &amp;&amp; rjust &amp;&amp; center</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-partition-amp-amp-rpartition"><span class="nav-number">1.3.14.</span> <span class="nav-text">14 **partition **&amp;&amp; rpartition</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-splitlines"><span class="nav-number">1.3.15.</span> <span class="nav-text">15 splitlines</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E5%85%B8"><span class="nav-number">1.4.</span> <span class="nav-text">字典</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%9F%A5%E6%89%BE"><span class="nav-number">1.4.1.</span> <span class="nav-text">1 查找</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0"><span class="nav-number">1.4.2.</span> <span class="nav-text">2 删除元素</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%97%E8%A1%A8"><span class="nav-number">1.5.</span> <span class="nav-text">列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E9%95%BF%E5%BA%A6%E3%80%81%E5%8A%A0%E6%B3%95%E3%80%81%E4%B9%98%E6%B3%95"><span class="nav-number">1.5.1.</span> <span class="nav-text">1 长度、加法、乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%B7%BB%E5%8A%A0%E5%85%83%E7%B4%A0"><span class="nav-number">1.5.2.</span> <span class="nav-text">2 添加元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%9F%A5%E6%89%BE"><span class="nav-number">1.5.3.</span> <span class="nav-text">3 查找</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%88%A0%E9%99%A4%E5%85%83%E7%B4%A0"><span class="nav-number">1.5.4.</span> <span class="nav-text">4 删除元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%88%97%E8%A1%A8%E7%94%9F%E6%88%90%E5%BC%8F"><span class="nav-number">1.5.5.</span> <span class="nav-text">5 列表生成式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E6%8E%92%E5%BA%8F"><span class="nav-number">1.5.6.</span> <span class="nav-text">6 排序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%83%E7%BB%84"><span class="nav-number">1.6.</span> <span class="nav-text">元组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="nav-number">1.7.1.</span> <span class="nav-text">函数参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F"><span class="nav-number">1.7.2.</span> <span class="nav-text">局部变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.3.</span> <span class="nav-text">返回函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AD%E5%8C%85"><span class="nav-number">1.7.4.</span> <span class="nav-text">闭包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.5.</span> <span class="nav-text">匿名函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%8F%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.6.</span> <span class="nav-text">偏函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">1.8.</span> <span class="nav-text">生成器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="nav-number">1.9.</span> <span class="nav-text">迭代器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="nav-number">1.10.</span> <span class="nav-text">装饰器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%B1%BB"><span class="nav-number">1.11.</span> <span class="nav-text">类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#init-%E6%96%B9%E6%B3%95"><span class="nav-number">1.11.1.</span> <span class="nav-text">__init__()方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#str-%E6%96%B9%E6%B3%95"><span class="nav-number">1.11.2.</span> <span class="nav-text">__str__() 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#del-%E6%96%B9%E6%B3%95"><span class="nav-number">1.11.3.</span> <span class="nav-text">__del__()方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF"><span class="nav-number">1.11.4.</span> <span class="nav-text">继承</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%80%81"><span class="nav-number">1.11.5.</span> <span class="nav-text">多态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7"><span class="nav-number">1.11.6.</span> <span class="nav-text">类属性和实例属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E6%96%B9%E6%B3%95%E5%92%8C%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="nav-number">1.11.7.</span> <span class="nav-text">类方法和静态方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#new%E6%96%B9%E6%B3%95"><span class="nav-number">1.11.8.</span> <span class="nav-text">new方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="nav-number">1.11.9.</span> <span class="nav-text">单例模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#slots-%E9%99%90%E5%88%B6class%E5%AE%9E%E4%BE%8B%E6%B7%BB%E5%8A%A0%E5%B1%9E%E6%80%A7"><span class="nav-number">1.11.10.</span> <span class="nav-text">__slots__限制class实例添加属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#property"><span class="nav-number">1.11.11.</span> <span class="nav-text">@property</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E7%B1%BB"><span class="nav-number">1.11.12.</span> <span class="nav-text">枚举类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97"><span class="nav-number">1.12.</span> <span class="nav-text">模块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sys%E6%A8%A1%E5%9D%97"><span class="nav-number">1.12.1.</span> <span class="nav-text">sys模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sys-path"><span class="nav-number">1.12.2.</span> <span class="nav-text">sys.path</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="nav-number">1.13.</span> <span class="nav-text">文件读写</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95"><span class="nav-number">1.14.</span> <span class="nav-text">操作文件和目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">1.15.</span> <span class="nav-text">序列化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">高级语法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B"><span class="nav-number">2.1.</span> <span class="nav-text">多进程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-multiprocessing"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">1. multiprocessing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Pool"><span class="nav-number">2.1.0.2.</span> <span class="nav-text">2. Pool</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-number">2.1.0.3.</span> <span class="nav-text">3 进程间通信</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="nav-number">2.2.</span> <span class="nav-text">多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Lock"><span class="nav-number">2.2.1.</span> <span class="nav-text">Lock()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#datetime"><span class="nav-number">2.3.</span> <span class="nav-text">datetime</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#collections"><span class="nav-number">2.4.</span> <span class="nav-text">collections</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#python%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B"><span class="nav-number">3.</span> <span class="nav-text">python高级编程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#1%E3%80%81%E6%80%BB%E8%A7%88"><span class="nav-number">4.</span> <span class="nav-text">1、总览</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2%E3%80%81Python%E4%B8%AD%E4%B8%80%E5%88%87%E7%9A%86%E5%AF%B9%E8%B1%A1"><span class="nav-number">5.</span> <span class="nav-text">2、Python中一切皆对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1%E5%8A%A8%E6%80%81%E8%AF%AD%E8%A8%80%E5%92%8C%E9%9D%99%E6%80%81%E8%AF%AD%E8%A8%80%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">5.1.</span> <span class="nav-text">2.1动态语言和静态语言的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2%E5%87%BD%E6%95%B0%E5%92%8C%E7%B1%BB%E4%B9%9F%E6%98%AF%E5%AF%B9%E8%B1%A1-%E5%B1%9E%E4%BA%8Epython%E7%9A%84%E4%B8%80%E7%AD%89%E5%85%AC%E6%B0%91"><span class="nav-number">5.2.</span> <span class="nav-text">2.2函数和类也是对象,属于python的一等公民</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3type%E3%80%81object%E5%92%8Cclass%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-number">5.3.</span> <span class="nav-text">2.3type、object和class之间的关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#type%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%94%A8%E6%B3%95"><span class="nav-number">5.3.1.</span> <span class="nav-text">type的两种用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#type-gt-int-gt-1"><span class="nav-number">5.3.2.</span> <span class="nav-text">type-&gt;int-&gt;1</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4python%E4%B8%AD%E7%9A%84%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.4.</span> <span class="nav-text">2.4python中的内置类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#python%E4%B8%AD%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%89%E4%B8%AA%E7%89%B9%E5%BE%81"><span class="nav-number">5.4.1.</span> <span class="nav-text">python中对象的三个特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python%E4%B8%AD%E7%9A%84%E5%B8%B8%E8%A7%81%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">5.4.2.</span> <span class="nav-text">python中的常见内置类型</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3%E3%80%81%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="nav-number">6.</span> <span class="nav-text">3、魔法函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1%E4%BB%80%E4%B9%88%E6%98%AF%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="nav-number">6.1.</span> <span class="nav-text">3.1什么是魔法函数?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2%E5%AE%9E%E4%BE%8B"><span class="nav-number">6.2.</span> <span class="nav-text">3.2实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3%E5%B8%B8%E7%94%A8%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0-%E9%9D%9E%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.3.</span> <span class="nav-text">3.3常用魔法函数(非数学运算类型)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8%E7%A4%BA"><span class="nav-number">6.3.1.</span> <span class="nav-text">字符串表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9B%86%E5%90%88%E5%BA%8F%E5%88%97%E7%9B%B8%E5%85%B3"><span class="nav-number">6.3.2.</span> <span class="nav-text">集合序列相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E7%9B%B8%E5%85%B3"><span class="nav-number">6.3.3.</span> <span class="nav-text">迭代相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E8%B0%83%E7%94%A8"><span class="nav-number">6.3.4.</span> <span class="nav-text">可调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#with%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8"><span class="nav-number">6.3.5.</span> <span class="nav-text">with上下文管理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E8%BD%AC%E6%8D%A2"><span class="nav-number">6.3.6.</span> <span class="nav-text">数值转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%83%E7%B1%BB%E7%9B%B8%E5%85%B3"><span class="nav-number">6.3.7.</span> <span class="nav-text">元类相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E7%9B%B8%E5%85%B3"><span class="nav-number">6.3.8.</span> <span class="nav-text">属性相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6"><span class="nav-number">6.3.9.</span> <span class="nav-text">属性描述符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E7%A8%8B"><span class="nav-number">6.3.10.</span> <span class="nav-text">协程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4%E5%B8%B8%E7%94%A8%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0-%E6%95%B0%E5%AD%A6%E8%BF%90%E7%AE%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">6.4.</span> <span class="nav-text">3.4常用魔法函数(数学运算类型)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.1.</span> <span class="nav-text">一元运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%85%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.2.</span> <span class="nav-text">二元运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.3.</span> <span class="nav-text">算术运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.4.</span> <span class="nav-text">反向算术运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E9%87%8F%E8%B5%8B%E5%80%BC%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.5.</span> <span class="nav-text">增量赋值算术运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.6.</span> <span class="nav-text">位运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E5%90%91%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.7.</span> <span class="nav-text">反向位运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E9%87%8F%E8%B5%8B%E5%80%BC%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">6.4.8.</span> <span class="nav-text">增量赋值位运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8%E7%A4%BA-1"><span class="nav-number">6.4.9.</span> <span class="nav-text">字符串表示</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5len%E5%87%BD%E6%95%B0"><span class="nav-number">6.5.</span> <span class="nav-text">3.5len函数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4%E3%80%81%E6%B7%B1%E5%85%A5%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="nav-number">7.</span> <span class="nav-text">4、深入类和对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%A4%9A%E6%80%81"><span class="nav-number">7.1.</span> <span class="nav-text">4.1鸭子类型和多态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%B8%AD%E5%AD%90%E7%B1%BB%E5%9E%8B"><span class="nav-number">7.1.1.</span> <span class="nav-text">鸭子类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E7%9A%84extend"><span class="nav-number">7.1.2.</span> <span class="nav-text">列表的extend</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB-abc%E6%A8%A1%E5%9D%97"><span class="nav-number">7.2.</span> <span class="nav-text">4.2抽象基类(abc模块)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="nav-number">7.2.1.</span> <span class="nav-text">抽象基类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E6%9C%89%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="nav-number">7.2.2.</span> <span class="nav-text">为什么要有抽象基类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#collection-abc%E6%A8%A1%E5%9D%97"><span class="nav-number">7.2.3.</span> <span class="nav-text">collection.abc模块</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E6%8A%BD%E8%B1%A1%E5%9F%BA%E7%B1%BB"><span class="nav-number">7.2.4.</span> <span class="nav-text">声明抽象基类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3isinstance%E5%92%8Ctype%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">7.3.</span> <span class="nav-text">4.3isinstance和type的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-4%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8F"><span class="nav-number">7.4.</span> <span class="nav-text">4.4类变量和实例变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-5%E7%B1%BB%E5%92%8C%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7%E7%9A%84%E6%9F%A5%E6%89%BE%E9%A1%BA%E5%BA%8F%E2%80%94mro%E6%9F%A5%E6%89%BE"><span class="nav-number">7.5.</span> <span class="nav-text">4.5类和实例属性的查找顺序—mro查找</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MRO%E7%AE%97%E6%B3%95"><span class="nav-number">7.5.1.</span> <span class="nav-text">MRO算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#C3%E7%AE%97%E6%B3%95"><span class="nav-number">7.5.2.</span> <span class="nav-text">C3算法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-6%E7%B1%BB%E6%96%B9%E6%B3%95%E3%80%81%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E5%92%8C%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95"><span class="nav-number">7.6.</span> <span class="nav-text">4.6类方法、静态方法和实例方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95"><span class="nav-number">7.6.1.</span> <span class="nav-text">实例方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="nav-number">7.6.2.</span> <span class="nav-text">静态方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E6%96%B9%E6%B3%95"><span class="nav-number">7.6.3.</span> <span class="nav-text">类方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E6%AF%94"><span class="nav-number">7.6.4.</span> <span class="nav-text">对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-7%E6%95%B0%E6%8D%AE%E5%B0%81%E8%A3%85%E5%92%8C%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7"><span class="nav-number">7.7.</span> <span class="nav-text">4.7数据封装和私有属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%81%E6%9C%89%E5%B1%9E%E6%80%A7"><span class="nav-number">7.7.1.</span> <span class="nav-text">私有属性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-8python%E5%AF%B9%E8%B1%A1%E7%9A%84%E8%87%AA%E7%9C%81%E6%9C%BA%E5%88%B6"><span class="nav-number">7.8.</span> <span class="nav-text">4.8python对象的自省机制.</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#bases-%E5%92%8Cissubclass"><span class="nav-number">7.8.1.</span> <span class="nav-text">__bases__和issubclass</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-9super%E7%9C%9F%E7%9A%84%E6%98%AF%E8%B0%83%E7%94%A8%E7%88%B6%E7%B1%BB%E5%90%97"><span class="nav-number">7.9.</span> <span class="nav-text">4.9super真的是调用父类吗</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#super%E7%9C%9F%E6%AD%A3%E8%B0%83%E7%94%A8%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number">7.9.1.</span> <span class="nav-text">super真正调用的是什么?</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-10mixin%E7%BB%A7%E6%89%BF%E6%A1%88%E4%BE%8B-django-rest-framework"><span class="nav-number">7.10.</span> <span class="nav-text">4.10mixin继承案例-django rest framework</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Mixin%E7%B1%BB"><span class="nav-number">7.10.1.</span> <span class="nav-text">Mixin类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mixin%E6%A8%A1%E5%BC%8F%E7%89%B9%E7%82%B9"><span class="nav-number">7.10.2.</span> <span class="nav-text">Mixin模式特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-11python%E4%B8%AD%E7%9A%84with%E8%AF%AD%E5%8F%A5"><span class="nav-number">7.11.</span> <span class="nav-text">4.11python中的with语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8"><span class="nav-number">7.11.1.</span> <span class="nav-text">上下文管理器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-12-contextlib%E7%AE%80%E5%8C%96%E4%B8%8A%E4%B8%8B%E6%96%87%E7%AE%A1%E7%90%86%E5%99%A8"><span class="nav-number">7.12.</span> <span class="nav-text">4.12 contextlib简化上下文管理器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5%E3%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BA%8F%E5%88%97%E7%B1%BB"><span class="nav-number">8.</span> <span class="nav-text">5、自定义序列类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1python%E4%B8%AD%E7%9A%84%E5%BA%8F%E5%88%97%E5%88%86%E7%B1%BB"><span class="nav-number">8.1.</span> <span class="nav-text">5.1python中的序列分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2python%E4%B8%AD%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B%E7%9A%84abc%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="nav-number">8.2.</span> <span class="nav-text">5.2python中序列类型的abc继承关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="nav-number">8.2.1.</span> <span class="nav-text">序列类型的协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sequence"><span class="nav-number">8.2.2.</span> <span class="nav-text">Sequence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MutableSequence"><span class="nav-number">8.2.3.</span> <span class="nav-text">MutableSequence</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-list%E4%B8%ADextend%E6%96%B9%E6%B3%95%E5%8C%BA%E5%88%AB"><span class="nav-number">8.3.</span> <span class="nav-text">5.3 list中extend方法区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E7%9A%84-%E3%80%81-x3D-%E5%92%8Cextend%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">8.3.1.</span> <span class="nav-text">序列的+、+&#x3D;和extend的区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-%E5%AE%9E%E7%8E%B0%E5%8F%AF%E5%88%87%E7%89%87%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">8.4.</span> <span class="nav-text">5.4 实现可切片的对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E7%89%87%E7%A5%9E%E6%93%8D%E4%BD%9C%EF%BC%8C%E4%BD%A0%E4%BC%9A%E5%A4%9A%E5%B0%91"><span class="nav-number">8.4.1.</span> <span class="nav-text">切片神操作，你会多少?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E7%89%87%E5%8F%96%E5%80%BC"><span class="nav-number">8.4.2.</span> <span class="nav-text">切片取值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E7%89%87%E8%B5%8B%E5%80%BC"><span class="nav-number">8.4.3.</span> <span class="nav-text">切片赋值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E4%B8%8D%E5%8F%AF%E5%8F%98%E7%9A%84%E5%BA%8F%E5%88%97%E7%B1%BB"><span class="nav-number">8.4.4.</span> <span class="nav-text">编写一个不可变的序列类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-5-bisect%E7%BB%B4%E6%8A%A4%E5%B7%B2%E6%8E%92%E5%BA%8F%E5%BA%8F%E5%88%97"><span class="nav-number">8.5.</span> <span class="nav-text">5.5 bisect维护已排序序列</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97"><span class="nav-number">8.5.1.</span> <span class="nav-text">序列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#bisect%E7%94%A8%E4%BA%8E%E7%BB%B4%E6%8A%A4%E5%B7%B2%E6%8E%92%E5%BA%8F%E5%BA%8F%E5%88%97"><span class="nav-number">8.5.2.</span> <span class="nav-text">bisect用于维护已排序序列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-6-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E6%88%91%E4%BB%AC%E4%B8%8D%E8%AF%A5%E4%BD%BF%E7%94%A8%E5%88%97%E8%A1%A8"><span class="nav-number">8.6.</span> <span class="nav-text">5.6 什么时候我们不该使用列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#array"><span class="nav-number">8.6.1.</span> <span class="nav-text">array</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-7-%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC%E5%BC%8F%E3%80%81%E7%94%9F%E6%88%90%E5%99%A8%E8%A1%A8%E8%BE%BE%E5%BC%8F%E3%80%81%E5%AD%97%E5%85%B8%E6%8E%A8%E5%AF%BC%E5%BC%8F"><span class="nav-number">8.7.</span> <span class="nav-text">5.7 列表推导式、生成器表达式、字典推导式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6%E3%80%81%E6%B7%B1%E5%85%A5python%E7%9A%84set%E5%92%8Cdict"><span class="nav-number">9.</span> <span class="nav-text">6、深入python的set和dict</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-dict%E7%9A%84abc%E7%BB%A7%E6%89%BF%E5%85%B3%E7%B3%BB"><span class="nav-number">9.1.</span> <span class="nav-text">6.1 dict的abc继承关系</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dict"><span class="nav-number">9.1.1.</span> <span class="nav-text">dict</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-dict%E7%9A%84%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">9.2.</span> <span class="nav-text">6.2 dict的常用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dict%E7%9A%84%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">9.2.1.</span> <span class="nav-text">dict的常用操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-dict%E7%9A%84%E5%AD%90%E7%B1%BB"><span class="nav-number">9.3.</span> <span class="nav-text">6.3 dict的子类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#UserDict"><span class="nav-number">9.3.1.</span> <span class="nav-text">UserDict</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#defaultdict"><span class="nav-number">9.3.2.</span> <span class="nav-text">defaultdict</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-4-set%E5%92%8Cfrozenset"><span class="nav-number">9.4.</span> <span class="nav-text">6.4 set和frozenset</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#set-%E5%92%8C-frozenset%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF%E5%8F%8A%E5%8C%BA%E5%88%AB"><span class="nav-number">9.4.1.</span> <span class="nav-text">set 和 frozenset的应用场景及区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#frozenset"><span class="nav-number">9.4.2.</span> <span class="nav-text">frozenset</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">9.4.3.</span> <span class="nav-text">常用方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-5-dict%E5%92%8Cset%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86"><span class="nav-number">9.5.</span> <span class="nav-text">6.5 dict和set的实现原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%88%E7%8E%87"><span class="nav-number">9.5.1.</span> <span class="nav-text">效率</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7%E3%80%81%E5%AF%B9%E8%B1%A1%E5%BC%95%E7%94%A8%E3%80%81%E5%8F%AF%E5%8F%98%E6%80%A7%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="nav-number">10.</span> <span class="nav-text">7、对象引用、可变性和垃圾回收</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-python%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F"><span class="nav-number">10.1.</span> <span class="nav-text">7.1 python中的变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-x3D-x3D-%E5%92%8Cis%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">10.2.</span> <span class="nav-text">7.2 &#x3D;&#x3D;和is的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-del%E8%AF%AD%E5%8F%A5%E5%92%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6"><span class="nav-number">10.3.</span> <span class="nav-text">7.3 del语句和垃圾回收</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Python%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6"><span class="nav-number">10.3.1.</span> <span class="nav-text">Python的垃圾回收机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="nav-number">10.3.2.</span> <span class="nav-text">垃圾回收魔法函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-%E4%B8%80%E4%B8%AA%E7%BB%8F%E5%85%B8%E7%9A%84%E5%8F%82%E6%95%B0%E9%94%99%E8%AF%AF"><span class="nav-number">10.4.</span> <span class="nav-text">7.4 一个经典的参数错误.</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%E9%94%99%E8%AF%AF"><span class="nav-number">10.4.1.</span> <span class="nav-text">经典参数传递错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">10.4.2.</span> <span class="nav-text">总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8%E3%80%81%E5%85%83%E7%B1%BB%E7%BC%96%E7%A8%8B"><span class="nav-number">11.</span> <span class="nav-text">8、元类编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#8-1-property%E5%8A%A8%E6%80%81%E5%B1%9E%E6%80%A7"><span class="nav-number">11.1.</span> <span class="nav-text">8.1 property动态属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E5%AF%BC%E5%85%A5"><span class="nav-number">11.1.1.</span> <span class="nav-text">模块的导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#property%E8%A3%85%E9%A5%B0%E5%99%A8-%E5%B1%9E%E6%80%A7%E6%96%B9%E6%B3%95"><span class="nav-number">11.1.2.</span> <span class="nav-text">property装饰器(属性方法)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E7%89%B9%E7%82%B9"><span class="nav-number">11.1.3.</span> <span class="nav-text">最大特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-2-getattr-%E3%80%81-getattribute-%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="nav-number">11.2.</span> <span class="nav-text">8.2 __getattr__、__getattribute__魔法函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#getattr-%E5%92%8C-getattribute-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">11.2.1.</span> <span class="nav-text">__getattr__和__getattribute__的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#getattribute"><span class="nav-number">11.2.2.</span> <span class="nav-text">__getattribute__</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-3-%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6%E5%92%8C%E5%B1%9E%E6%80%A7%E6%9F%A5%E6%89%BE%E8%BF%87%E7%A8%8B"><span class="nav-number">11.3.</span> <span class="nav-text">8.3 属性描述符和属性查找过程.</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0%E7%AC%A6-1"><span class="nav-number">11.3.1.</span> <span class="nav-text">属性描述符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#user-age%E7%9A%84%E6%9F%A5%E6%89%BE%E9%A1%BA%E5%BA%8F"><span class="nav-number">11.3.2.</span> <span class="nav-text">user.age的查找顺序</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-4-new-%E5%92%8C-init-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">11.4.</span> <span class="nav-text">8.4 __new__和__init__的区别</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#new-%E5%92%8C-init-%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0%E5%8C%BA%E5%88%AB"><span class="nav-number">11.4.1.</span> <span class="nav-text">__new__和__init__魔法函数区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-5-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%83%E7%B1%BB"><span class="nav-number">11.5.</span> <span class="nav-text">8.5 自定义元类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">11.5.1.</span> <span class="nav-text">创建类的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%85%83%E7%B1%BB"><span class="nav-number">11.5.2.</span> <span class="nav-text">自定义元类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-6-%E9%80%9A%E8%BF%87%E5%85%83%E7%B1%BB%E5%AE%9E%E7%8E%B0orm"><span class="nav-number">11.6.</span> <span class="nav-text">8.6 通过元类实现orm</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#9%E3%80%81%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">12.</span> <span class="nav-text">9、迭代器和生成器</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Luoshuqiang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
